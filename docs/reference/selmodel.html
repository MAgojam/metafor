<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light"><script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Selection Models — selmodel • metafor</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Selection Models — selmodel"><meta property="og:description" content="Function to fit selection models. "><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@wviechtb"><meta name="twitter:site" content="@wviechtb"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)"><!-- preferably CSS --><link rel="stylesheet" href="../preferably.css"><link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)"><script src="../darkswitch.js"></script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.1-16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/article/view/v036i03" class="external-link">JSS Article</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
          <a href="#" id="css-toggle-btn">
            <span class="fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        <li>
  <a href="https://twitter.com/wviechtb" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
        
        


      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Selection Models</h1>
    
    <div class="hidden name"><code>selmodel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to fit selection models. <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">selmodel</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for rma.uni</span></span>
<span><span class="fu">selmodel</span><span class="op">(</span><span class="va">x</span>, <span class="va">type</span>, alternative<span class="op">=</span><span class="st">"greater"</span>, <span class="va">prec</span>,</span>
<span>         <span class="va">delta</span>, <span class="va">steps</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">digits</span>, <span class="va">control</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>an object of class <code>"rma.uni"</code>.</p></dd>

   <dt>type</dt>
<dd><p>character string to specify the type of selection model. Possible options are <code>"beta"</code>, <code>"halfnorm"</code>, <code>"negexp"</code>, <code>"logistic"</code>, <code>"power"</code>, <code>"negexppow"</code>, <code>"stepfun"</code>, <code>"trunc"</code>, and <code>"truncest"</code>. Can be abbreviated. See ‘Details’.</p></dd>

   <dt>alternative</dt>
<dd><p>character string to specify the sidedness of the hypothesis when testing the observed outcomes. Possible options are <code>"greater"</code> (the default), <code>"less"</code>, or <code>"two.sided"</code>. Can be abbreviated.</p></dd>

   <dt>prec</dt>
<dd><p>optional character string to specify the measure of precision (only relevant for selection models that can incorporate this into the selection function). Possible options are <code>"sei"</code>, <code>"vi"</code>, <code>"ninv"</code>, or <code>"sqrtninv"</code>. See ‘Details’.</p></dd>

   <dt>delta</dt>
<dd><p>optional numeric vector (of the same length as the number of selection model parameters) to fix the corresponding <em></em>\(\delta\) value(s). A specific <em></em>\(\delta\) value can be fixed by setting the corresponding element of this argument to the desired value. A specific <em></em>\(\delta\) value will be estimated if the corresponding element is set equal to <code>NA</code>. See ‘Details’.</p></dd>

   <dt>steps</dt>
<dd><p>numeric vector of one or more values that can or must be specified for certain selection functions. See ‘Details’.</p></dd>

   <dt>verbose</dt>
<dd><p>logical to specify whether output should be generated on the progress of the model fitting (the default is <code>FALSE</code>). Can also be an integer. Values &gt; 1 generate more verbose output. See ‘Note’.</p></dd>

   <dt>digits</dt>
<dd><p>optional integer to specify the number of decimal places to which the printed results should be rounded. If unspecified, the default is to take the value from the object.</p></dd>

   <dt>control</dt>
<dd><p>optional list of control values for the estimation algorithm. See ‘Note’.</p></dd>

   <dt>...</dt>
<dd><p>other arguments.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Selection models are a general class of models that attempt to model the process by which the studies included in a meta-analysis may have been influenced by some form of publication bias. If a particular selection model is an adequate approximation for the underlying selection process, then the model provides estimates of the parameters of interest (e.g., the average true outcome and the amount of heterogeneity in the true outcomes) that are ‘corrected’ for this selection process (i.e., they are estimates of the parameters in the population of studies before any selection has taken place). The present function fits a variety of such selection models. To do so, one should pass an object fitted with the <code><a href="rma.uni.html">rma.uni</a></code> function to the first argument. The model that will then be fitted is of the same form as the original model combined with the specific selection model chosen (see below for possible options). For example, if the original model was a random-effects model, then a random-effects selection model will be fitted. Similarly, if the original model included moderators, then they will also be accounted for in the selection model fitted. Model fitting is done via maximum likelihood (ML) estimation over the fixed- and random-effects parameters (e.g., <em></em>\(\mu\) and <em></em>\(\tau^2\) in a random-effects model) and the selection model parameters.</p>
<p>Argument <code>type</code> determines the specific type of selection model that should be fitted. Many selection models are based on the idea that selection may haven taken place based on the p-values of the studies. In particular, let <em></em>\(y_i\) and <em></em>\(v_i\) denote the observed outcome and the corresponding sampling variance of the <em></em>\(i\textrm{th}\) study. Then <em></em>\(z_i = y_i / \sqrt{v_i}\) is the (Wald-type) test statistic for testing the null hypothesis <em></em>\(\mbox{H}_0{:}\; \theta_i = 0\) and <em></em>\(p_i = 1 - \Phi(z_i)\) (if <code>alternative="greater"</code>), <em></em>\(p_i = \Phi(z_i)\) (if <code>alternative="less"</code>), or <em></em>\(p_i = 2(1 - \Phi(|z_i|))\) (if <code>alternative="two.sided"</code>) the corresponding (one- or two-sided) p-value, where <em></em>\(\Phi()\) denotes the cumulative distribution function of a standard normal distribution. Finally, let <em></em>\(w(p_i)\) denote some function that specifies the relative likelihood of selection given the p-value of a study.</p>
<p>If <em></em>\(w(p_i) &gt; w(p_{i'})\) when <em></em>\(p_i &lt; p_{i'}\) (i.e., <em></em>\(w(p_i)\) is larger for smaller p-values), then <code>alternative="greater"</code> implies selection in favor of increasingly significant positive outcomes, <code>alternative="less"</code> implies selection in favor of increasingly significant negative outcomes, and <code>alternative="two.sided"</code> implies selection in favor of increasingly significant outcomes regardless of their direction.</p>
<p></p><div class="section">
<h3 id="beta-selection-model">Beta Selection Model<a class="anchor" aria-label="anchor" href="#beta-selection-model"></a></h3>


<p>When <code>type="beta"</code>, the function can be used to fit the ‘beta selection model’ by Citkowicz and Vevea (2017). For this model, the selection function is given by \[w(p_i) = p_i^{\delta_1 - 1} \times (1 - p_i)^{\delta_2 - 1}\] where <em></em>\(\delta_1 &gt; 0\) and <em></em>\(\delta_2 &gt; 0\). The null hypothesis <em></em>\(\mbox{H}_0{:}\; \delta_1 = \delta_2 = 1\) represents the case where there is no selection (at least not depending on the p-values). The figure below illustrates with some examples how the relative likelihood of selection can depend on the p-value for various combinations of <em></em>\(\delta_1\) and <em></em>\(\delta_2\). Note that the model allows for a non-monotonic selection function.</p>
<p><img src="figures/selmodel-beta.png" width="600"></p>
<p></p>
</div>

<p></p><div class="section">
<h3 id="half-normal-negative-exponential-logistic-and-power-selection-models">Half-Normal, Negative-Exponential, Logistic, and Power Selection Models<a class="anchor" aria-label="anchor" href="#half-normal-negative-exponential-logistic-and-power-selection-models"></a></h3>


<p>Preston et al. (2004) suggested the first three of the following selection functions:</p>
<p></p><table class="table table"><tr><td><b>name</b></td><td> </td><td><b><code>type</code></b></td><td> </td><td><b>selection function</b></td></tr><tr><td>half-normal</td><td> </td><td><code>"halfnorm"</code></td><td> </td><td><em></em>\(w(p_i) = \exp(-\delta \times p_i^2)\)</td></tr><tr><td>negative-exponential</td><td> </td><td><code>"negexp"</code></td><td> </td><td><em></em>\(w(p_i) = \exp(-\delta \times p_i)\)</td></tr><tr><td>logistic</td><td> </td><td><code>"logistic"</code></td><td> </td><td><em></em>\(w(p_i) = 2 \times \exp(-\delta \times p_i) / (1 + \exp(-\delta \times p_i))\)</td></tr><tr><td>power</td><td> </td><td><code>"power"</code></td><td> </td><td><em></em>\(w(p_i) = (1-p_i)^\delta\)</td></tr></table><p>The power selection model is added here as it has similar properties as the models suggested by Preston et al. (2004). For all models, assume <em></em>\(\delta \ge 0\), so that all functions imply a monotonically decreasing relationship between the p-value and the selection probability. For all functions, <em></em>\(\mbox{H}_0{:}\; \delta = 0\) implies no selection. The figure below shows the relative likelihood of selection as a function of the p-value for <em></em>\(\delta = 0\) and for the various selection functions when <em></em>\(\delta = 6\).</p>
<p><img src="figures/selmodel-preston.png" width="600"></p>
<p>Here, these functions are extended to allow for the possibility that <em></em>\(w(p_i) = 1\) for p-values below a certain significance threshold denoted by <em></em>\(\alpha\) (e.g., to model the case that the relative likelihood of selection is equally high for all significant studies but decreases monotonically for p-values above the significance threshold). To fit such a selection model, one should specify the <em></em>\(\alpha\) value (with <em></em>\(0 &lt; \alpha &lt; 1\)) via the <code>steps</code> argument. There must be at least one observed p-value below and one observed p-value above the chosen threshold to fit these models. The figure below shows some examples of the relative likelihood of selection when <code>steps=.05</code>.</p>
<p><img src="figures/selmodel-preston-step.png" width="600"></p>
<p>Preston et al. (2004) also suggested selection functions where the relatively likelihood of selection not only depends on the p-value, but also the precision (e.g., standard error) of the estimate (if two studies have similar p-values, it may be plausible to assume that the larger / more precise study has a higher probability of selection). These selection functions (plus the corresponding power function) are given by:</p>
<p></p><table class="table table"><tr><td><b>name</b></td><td> </td><td><b><code>type</code></b></td><td> </td><td><b>selection function</b></td></tr><tr><td>half-normal</td><td> </td><td><code>"halfnorm"</code></td><td> </td><td><em></em>\(w(p_i) = \exp(-\delta \times \mathrm{prec}_i \times p_i^2)\)</td></tr><tr><td>negative-exponential</td><td> </td><td><code>"negexp"</code></td><td> </td><td><em></em>\(w(p_i) = \exp(-\delta \times \mathrm{prec}_i \times p_i)\)</td></tr><tr><td>logistic</td><td> </td><td><code>"logistic"</code></td><td> </td><td><em></em>\(w(p_i) = 2 \times \exp(-\delta \times \mathrm{prec}_i \times p_i) / (1 + \exp(-\delta \times \mathrm{prec}_i \times p_i))\)</td></tr><tr><td>power</td><td> </td><td><code>"power"</code></td><td> </td><td><em></em>\(w(p_i) = (1-p_i)^{\delta \times \mathrm{prec}_i}\)</td></tr></table><p>where <em></em>\(\mathrm{prec}_i = \sqrt{v_i}\) (i.e., the standard error of the <em></em>\(i\textrm{th}\) study) according to Preston et al. (2004). Here, this idea is generalized to allow the user to specify the specific measure of precision to use (via the <code>prec</code> argument). Possible options are:</p><ul><li><p><code>prec="sei"</code> for the standard errors,</p></li>
<li><p><code>prec="vi"</code> for the sampling variances,</p></li>
<li><p><code>prec="ninv"</code> for the inverse of the sample sizes,</p></li>
<li><p><code>prec="sqrtninv"</code> for the inverse square root of the sample sizes.</p></li>
</ul><p>Using some function of the sample sizes as a measure of precision is only possible when information about the sample sizes is actually stored within the object passed to the <code>selmodel</code> function. See ‘Note’.</p>
<p>Note that <em></em>\(\mathrm{prec}_i\) is really a measure of imprecision (with higher values corresponding to lower precision). Also, regardless of the specific measure chosen, the values are actually rescaled with <em></em>\(\mathrm{prec}_i = \mathrm{prec}_i / \max(\mathrm{prec}_i)\) inside of the function, such that <em></em>\(\mathrm{prec}_i = 1\) for the least precise study and <em></em>\(\mathrm{prec}_i &lt; 1\) for the remaining studies (the rescaling does not actually change the fit of the model, it only helps to improve the stability of model fitting algorithm). The figure below shows some examples of the relative likelihood of selection using these selection functions for two different precision values (note that lower values of <em></em>\(\mathrm{prec}\) lead to a higher likelihood of selection).</p>
<p><img src="figures/selmodel-preston-prec.png" width="600"></p>
<p>One can also use the <code>steps</code> argument as described above in combination with these selection functions (studies with p-values below the chosen threshold then have <em></em>\(w(p_i) = 1\) regardless of their exact p-value or precision).</p>
<p></p>
</div>

<p></p><div class="section">
<h3 id="negative-exponential-power-selection-model">Negative Exponential Power Selection Model<a class="anchor" aria-label="anchor" href="#negative-exponential-power-selection-model"></a></h3>


<p>As an extension of the half-normal and negative-exponential models, one can also choose <code>type="negexppow"</code> for a ‘negative exponential power selection model’. The selection function for this model is given by \[w(p_i) = \exp(-\delta_1 \times p_i^{1/\delta_2})\] where <em></em>\(\delta_1 \ge 0\) and <em></em>\(\delta_2 \ge 0\) (see Begg &amp; Mazumdar, 1994, although here a different parameterization is used, such that increasing <em></em>\(\delta_2\) leads to more severe selection). The figure below shows some examples of this selection function when holding <em></em>\(\delta_1\) constant while increasing <em></em>\(\delta_2\).</p>
<p><img src="figures/selmodel-negexppow.png" width="600"></p>
<p>This model affords greater flexibility in the shape of the selection function, but requires the estimation of the additional power parameter (the half-normal and negative-exponential models are therefore special cases when fixing <em></em>\(\delta_2\) to 0.5 or 1, respectively). <em></em>\(\mbox{H}_0{:}\; \delta_1 = 0\) again implies no selection, but so does <em></em>\(\mbox{H}_0{:}\; \delta_2 = 0\).</p>
<p>One can again use the <code>steps</code> argument to specify a single significance threshold, <em></em>\(\alpha\), so that <em></em>\(w(p_i) = 1\) for p-values below this threshold and otherwise <em></em>\(w(p_i)\) follows the selection function as given above. One can also use the <code>prec</code> argument to specify a measure of precision in combination with this model, which leads to the selection function \[w(p_i) = \exp(-\delta_1 \times \mathrm{prec}_i \times p_i^{1/\delta_2})\] and hence is the logical extension of the negative exponential power selection model that also incorporates some measure of precision into the selection process.</p>
<p></p>
</div>

<p></p><div class="section">
<h3 id="step-function-selection-models">Step Function Selection Models<a class="anchor" aria-label="anchor" href="#step-function-selection-models"></a></h3>


<p>When <code>type="stepfun"</code>, the function can be used to fit ‘step function models’ as described by Iyengar and Greenhouse (1988), Hedges (1992), Vevea and Hedges (1995), and Vevea and Woods (2005). For these models, one must specify one or multiple values via the <code>steps</code> argument, which define intervals in which the relative likelihood of selection is constant. Let \[\alpha_1 &lt; \alpha_2 &lt; \ldots &lt; \alpha_c\] denote these cutpoints sorted in increasing order, with the constraint that <em></em>\(\alpha_c = 1\) (if the highest value specified via <code>steps</code> is not 1, the function will automatically add this cutpoint), and define <em></em>\(\alpha_0 = 0\). The selection function is then given by <em></em>\(w(p_i) = \delta_j\) if <em></em>\(\alpha_{j-1} &lt; p_i \le \alpha_j\). To make the model identifiable, we set <em></em>\(\delta_1 = 1\). The <em></em>\(\delta_j\) values therefore denote the likelihood of selection in the various intervals relative to the interval for p-values between 0 and <em></em>\(\alpha_1\). Hence, the null hypothesis <em></em>\(\mbox{H}_0{:}\; \delta_j = 1\) for <em></em>\(j = 1, \ldots, c\) implies no selection.</p>
<p>For example, if <code>steps=c(.05, .10, .50, 1)</code>, then <em></em>\(\delta_2\) is the likelihood of selection for p-values between .05 and .10, <em></em>\(\delta_3\) is the likelihood of selection for p-values between .10 and .50, and <em></em>\(\delta_4\) is the likelihood of selection for p-values between .50 and 1 relative to the likelihood of selection for p-values between 0 and .05. The figure below shows the corresponding selection function for some arbitrarily chosen <em></em>\(\delta_j\) values.</p>
<p><img src="figures/selmodel-stepfun.png" width="600"></p>
<p>There must be at least one observed p-value within each interval to fit this model. If this is not the case, an error will be issued (setting <code>verbose=TRUE</code> provides information about the number of p-values falling into each interval).</p>
<p>When specifying a single cutpoint in the context of a random-effects model, this model is sometimes called the ‘three-parameter selection model’ (3PSM), corresponding to the parameters <em></em>\(\mu\), <em></em>\(\tau^2\), and <em></em>\(\delta_2\) (e.g., Carter et al., 2019; McShane et al., 2016; Pustejovsky &amp; Rodgers, 2019). The same idea but in the context of an equal-effects model was also described by Iyengar and Greenhouse (1988).</p>
<p>Note that when <code>alternative="greater"</code> or <code>alternative="less"</code> (i.e., when we assume that the relative likelihood of selection is not only related to the p-values of the studies, but also the directionality of the outcomes), then it would usually make sense to divide conventional levels of significance (e.g., .05) by 2 before passing these values to the <code>steps</code> argument. For example, if we think that studies were selected for positive outcomes that are significant at two-tailed <em></em>\(\alpha = .05\), then we should use <code>alternative="greater"</code> in combination with <code>steps=c(.025, 1)</code>.</p>
<p>One of the challenges when fitting this model with many cutpoints is the large number of parameters that need to be estimated (which is especially problematic when the number of studies is small). An alternative approach suggested by Vevea and Woods (2005) is to fix the <em></em>\(\delta_j\) values to some a priori chosen values instead of estimating them. One can then conduct a sensitivity analysis by examining the results (e.g., the estimates of <em></em>\(\mu\) and <em></em>\(\tau^2\) in a random-effects model) for a variety of different sets of <em></em>\(\delta_j\) values (reflecting more or less severe forms of selection). This can be done by specifying the <em></em>\(\delta_j\) values via the <code>delta</code> argument. Table 1 in Vevea and Woods (2005) provides some illustrative examples of moderate and severe selection functions for one- and two-tailed selection. The code below creates a data frame that contains these functions.</p>
<p></p><div class="sourceCode"><pre><code><span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.35</span>, <span class="fl">0.50</span>, <span class="fl">0.65</span>, <span class="fl">0.75</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="fl">0.995</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  delta.mod.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.99</span>, <span class="fl">0.95</span>, <span class="fl">0.80</span>, <span class="fl">0.75</span>, <span class="fl">0.65</span>, <span class="fl">0.60</span>, <span class="fl">0.55</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span>,</span>
<span>  delta.sev.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.99</span>, <span class="fl">0.90</span>, <span class="fl">0.75</span>, <span class="fl">0.60</span>, <span class="fl">0.50</span>, <span class="fl">0.40</span>, <span class="fl">0.35</span>, <span class="fl">0.30</span>, <span class="fl">0.25</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>  delta.mod.2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.99</span>, <span class="fl">0.95</span>, <span class="fl">0.90</span>, <span class="fl">0.80</span>, <span class="fl">0.75</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span>, <span class="fl">0.75</span>, <span class="fl">0.80</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="fl">1.00</span><span class="op">)</span>,</span>
<span>  delta.sev.2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.99</span>, <span class="fl">0.90</span>, <span class="fl">0.75</span>, <span class="fl">0.60</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.60</span>, <span class="fl">0.75</span>, <span class="fl">0.90</span>, <span class="fl">0.99</span>, <span class="fl">1.00</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

<p>The figure below shows the corresponding selection functions.</p>
<p><img src="figures/selmodel-stepfun-fixed.png" width="600"></p>
<p>These four functions are “merely examples and should not be regarded as canonical” (Vevea &amp; Woods, 2005).</p>
<p></p>
</div>

<p></p><div class="section">
<h3 id="truncated-distribution-selection-model">Truncated Distribution Selection Model<a class="anchor" aria-label="anchor" href="#truncated-distribution-selection-model"></a></h3>


<p>When <code>type="trunc"</code>, the model assumes that the relative likelihood of selection depends not on the p-value but on the value of the observed effect size or outcome of a study. Let <em></em>\(y_c\) denote a single cutpoint (which can be specified via argument <code>steps</code> and which is assumed to be 0 when unspecified). Let \[w(y_i) = \left\{ \begin{matrix} \; 1 &amp; \textrm{if} \; y_i &gt; y_c \\ \; \delta_1 &amp; \textrm{if} \; y_i \le y_c \\ \end{matrix} \right.\] denote the selection function when <code>alternative="greater"</code> and \[w(y_i) = \left\{ \begin{matrix} \; 1 &amp; \textrm{if} \; y_i &lt; y_c \\ \; \delta_1 &amp; \textrm{if} \; y_i \ge y_c \\ \end{matrix} \right.\] when <code>alternative="less"</code> (note that <code>alternative="two.sided"</code> is not an option for this type of selection model). Therefore, when <code>alternative="greater"</code>, <em></em>\(\delta_1\) denotes the likelihood of selection for observed effect sizes or outcomes that fall below the chosen cutpoint relative to those that fall above it (and vice-versa when <code>alternative="less"</code>). Hence, the null hypothesis <em></em>\(\mbox{H}_0{:}\; \delta_1 = 1\) implies no selection.</p>
<p>In principle, it is also possible to obtain a maximum likelihood estimate of the cutpoint. For this, one can set <code>type="truncest"</code>, in which case the selection function is given by \[w(y_i) = \left\{ \begin{matrix} \; 1 &amp; \textrm{if} \; y_i &gt; \delta_2 \\ \; \delta_1 &amp; \textrm{if} \; y_i \le \delta_2 \\ \end{matrix} \right.\] when <code>alternative="greater"</code> and analogously when <code>alternative="less"</code>. Therefore, instead of specifying the cutpoint via the <code>steps</code> argument, it is estimated via <em></em>\(\delta_2\). Note that estimating both <em></em>\(\delta_1\) and <em></em>\(\delta_2\) simultaneously is typically very difficult (the likelihood surface is often quite rugged with multiple local optima) and will require a large number of studies. The implementation of this selection function should be considered experimental.</p>
<p>Models similar to those described above were proposed by Rust et al. (1990) and Formann (2008), but made various simplifying assumptions (e.g., Formann assumed <em></em>\(\delta_1 = 0\)) and did not account for the heteroscedastic nature of the sampling variances of the observed effect sizes or outcomes, nor did they allow for heterogeneity in the true effects or the influence of moderators.</p>
<p></p>
</div>


    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>c("rma.uni","rma")</code>. The object is a list containing the same components as a regular <code>c("rma.uni","rma")</code> object, but the parameter estimates are based on the selection model. Most importantly, the following elements are modified based on the selection model:</p>
<dl><dt>beta</dt>
<dd><p>estimated coefficients of the model.</p></dd>

   <dt>se</dt>
<dd><p>standard errors of the coefficients.</p></dd>

   <dt>zval</dt>
<dd><p>test statistics of the coefficients.</p></dd>

   <dt>pval</dt>
<dd><p>corresponding p-values.</p></dd>

   <dt>ci.lb</dt>
<dd><p>lower bound of the confidence intervals for the coefficients.</p></dd>

   <dt>ci.ub</dt>
<dd><p>upper bound of the confidence intervals for the coefficients.</p></dd>

   <dt>vb</dt>
<dd><p>variance-covariance matrix of the estimated coefficients.</p></dd>

   <dt>tau2</dt>
<dd><p>estimated amount of (residual) heterogeneity. Always <code>0</code> when <code>method="EE"</code>.</p></dd>

   <dt>se.tau2</dt>
<dd><p>standard error of the estimated amount of (residual) heterogeneity.</p></dd>


</dl><p>In addition, the object contains the following additional elements:</p>
<dl><dt>delta</dt>
<dd><p>estimated selection model parameter(s).</p></dd>

   <dt>se.delta</dt>
<dd><p>corresponding standard error(s).</p></dd>

   <dt>zval.delta</dt>
<dd><p>corresponding test statistic(s).</p></dd>

   <dt>pval.delta</dt>
<dd><p>corresponding p-value(s).</p></dd>

   <dt>ci.lb.delta</dt>
<dd><p>lower bound of the confidence intervals for the parameter(s).</p></dd>

   <dt>ci.ub.delta</dt>
<dd><p>upper bound of the confidence intervals for the parameter(s).</p></dd>

   <dt>LRT</dt>
<dd><p>test statistic of the likelihood ratio test for the selection model parameter(s).</p></dd>

   <dt>LRTdf</dt>
<dd><p>degrees of freedom for the likelihood ratio test.</p></dd>

   <dt>LRTp</dt>
<dd><p>p-value for the likelihood ratio test.</p></dd>

   <dt>LRT.tau2</dt>
<dd><p>test statistic of the likelihood ratio test for testing <em></em>\(\mbox{H}_0{:}\; \tau^2 = 0\) (<code>NA</code> when fitting an equal-effects model).</p></dd>

   <dt>LRTp.tau2</dt>
<dd><p>p-value for the likelihood ratio test.</p></dd>

   <dt>...</dt>
<dd><p>some additional elements/values.</p></dd>

</dl></div>
    <div id="methods">
    <h2>Methods</h2>
    <p>The results of the fitted model are formatted and printed with the <code><a href="print.rma.html">print</a></code> function. The estimated selection function can be drawn with <code><a href="plot.rma.uni.selmodel.html">plot</a></code>.</p>
<p>The <code><a href="profile.rma.html">profile</a></code> function can be used to obtain a plot of the log-likelihood as a function of <em></em>\(\tau^2\) and/or the selection model parameter(s) of the model. Corresponding confidence intervals can be obtained with the <code><a href="confint.rma.html">confint</a></code> function.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Model fitting is done via numerical optimization over the model parameters. By default, <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> with method <code>"BFGS"</code> is used for the optimization. One can also chose a different optimizer from <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> via the <code>control</code> argument (e.g., <code>control=list(optimizer="Nelder-Mead")</code>). Besides one of the methods from <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, one can also choose the quasi-Newton algorithm in <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code>, one of the optimizers from the <code>minqa</code> package (i.e., <code><a href="https://rdrr.io/pkg/minqa/man/uobyqa.html" class="external-link">uobyqa</a></code>, <code><a href="https://rdrr.io/pkg/minqa/man/newuoa.html" class="external-link">newuoa</a></code>, or <code><a href="https://rdrr.io/pkg/minqa/man/bobyqa.html" class="external-link">bobyqa</a></code>), one of the (derivative-free) algorithms from the <code><a href="https://rdrr.io/pkg/nloptr/man/nloptr.html" class="external-link">nloptr</a></code> package, the Newton-type algorithm implemented in <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">nlm</a></code>, the various algorithms implemented in the <code>dfoptim</code> package (<code><a href="https://rdrr.io/pkg/dfoptim/man/hookejeeves.html" class="external-link">hjk</a></code> for the Hooke-Jeeves, <code><a href="https://rdrr.io/pkg/dfoptim/man/nmkb.html" class="external-link">nmk</a></code> for the Nelder-Mead, and <code><a href="https://rdrr.io/pkg/dfoptim/man/mads.html" class="external-link">mads</a></code> for the Mesh Adaptive Direct Searches algorithm), the quasi-Newton type optimizers <code><a href="https://rdrr.io/pkg/ucminf/man/ucminf.html" class="external-link">ucminf</a></code> and <code><a href="https://rdrr.io/pkg/lbfgsb3c/man/lbfgsb3c.html" class="external-link">lbfgsb3c</a></code> and the subspace-searching simplex algorithm <code><a href="https://rdrr.io/pkg/subplex/man/subplex.html" class="external-link">subplex</a></code> from the packages of the same name, the Barzilai-Borwein gradient decent method implemented in <code><a href="https://rdrr.io/pkg/BB/man/BBoptim.html" class="external-link">BBoptim</a></code>, the <code><a href="https://rdrr.io/pkg/Rcgmin/man/Rcgmin.html" class="external-link">Rcgmin</a></code> and <code><a href="https://rdrr.io/pkg/Rvmmin/man/Rvmmin.html" class="external-link">Rvmmin</a></code> optimizers, or the parallelized version of the L-BFGS-B algorithm implemented in <code><a href="https://rdrr.io/pkg/optimParallel/man/optimParallel.html" class="external-link">optimParallel</a></code> from the package of the same name.</p>
<p>The optimizer name must be given as a character string (i.e., in quotes). Additional control parameters can be specified via the <code>control</code> argument (e.g., <code>control=list(maxit=1000, reltol=1e-8)</code>). For <code><a href="https://rdrr.io/pkg/nloptr/man/nloptr.html" class="external-link">nloptr</a></code>, the default is to use the BOBYQA implementation from that package with a relative convergence criterion of <code>1e-8</code> on the function value (i.e., log-likelihood), but this can be changed via the <code>algorithm</code> and <code>ftop_rel</code> arguments (e.g., <code>control=list(optimizer="nloptr", algorithm="NLOPT_LN_SBPLX", ftol_rel=1e-6)</code>). For <code><a href="https://rdrr.io/pkg/optimParallel/man/optimParallel.html" class="external-link">optimParallel</a></code>, the control argument <code>ncpus</code> can be used to specify the number of cores to use for the parallelization (e.g., <code>control=list(optimizer="optimParallel", ncpus=2)</code>). With <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>, one can check on the number of available cores on the local machine.</p>
<p>All selection models (except for <code>type="stepfun"</code>, <code>type="trunc"</code>, and <code>type="truncest"</code>) require repeated evaluations of an integral, which is done via adaptive quadrature as implemented in the <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></code> function. One can adjust the arguments of the <code>integrate</code> function via control element <code>intCtrl</code>, which is a list of named arguments (e.g., <code>control = list(intCtrl = list(rel.tol=1e-4, subdivisions=100))</code>).</p>
<p>The starting values for the fixed effects, the <em></em>\(\tau^2\) value (only relevant in random/mixed-effects selection models), and the <em></em>\(\delta\) parameter(s) are chosen automatically by the function, but one can also set the starting values manually via the <code>control</code> argument by specifying a vector of the appropriate length for <code>beta.init</code>, a single value for <code>tau2.init</code>, and a vector of the appropriate length for <code>delta.init</code>.</p>
<p>By default, the <em></em>\(\delta\) parameter(s) are constrained to a certain range, which improves the stability of the optimization algorithm. For all models, the maximum is set to <code>100</code> and the minimum to <code>0</code> (except for <code>type="beta"</code>, where the minimum for both parameters is <code>1e-5</code>). These defaults can be changed via the <code>control</code> argument by specifying a vector of the appropriate length for <code>delta.min</code> and/or <code>delta.max</code>.</p>
<p>A difficulty with fitting the beta selection model (i.e., <code>type="beta"</code>) is the behavior of <em></em>\(w(p_i)\) when <em></em>\(p_i = 0\) or <em></em>\(p_i = 1\). When <em></em>\(\delta_1 &lt; 1\) or <em></em>\(\delta_2 &lt; 1\), then this leads to selection weights equal to infinity, which causes problems when computing the likelihood function. Following Citkowicz and Vevea (2017), this problem can be avoided by censoring p-values too close to 0 or 1. The specific censoring point can be set via the <code>pval.min</code> element of the <code>control</code> argument. The default for this selection model is <code>control=list(pval.min=1e-5)</code>. A similar issue arises for the power selection model (i.e., <code>type="power"</code>) when <em></em>\(p_i = 1\). Again, <code>pval.min=1e-5</code> is used to circumvent this issue. For all other selection models, the default is <code>pval.min=0</code>.</p>
<p>The variance-covariance matrix corresponding to the estimates of the fixed effects, the <em></em>\(\tau^2\) value (only relevant in random/mixed-effects selection models), and the <em></em>\(\delta\) parameter(s) is obtained by inverting the Hessian, which is numerically approximated using the <code><a href="https://rdrr.io/pkg/numDeriv/man/hessian.html" class="external-link">hessian</a></code> function from the <code>numDeriv</code> package. This may fail, leading to <code>NA</code> values for the standard errors and hence test statistics, p-values, and confidence interval bounds. One can set control argument <code>hessianCtrl</code> to a list of named arguments to be passed on to the <code>method.args</code> argument of the <code><a href="https://rdrr.io/pkg/numDeriv/man/hessian.html" class="external-link">hessian</a></code> function (the default is <code>control=list(hessianCtrl=list(r=6))</code>). One can also set <code>control=list(hesspack="pracma")</code> in which case the <code><a href="https://rdrr.io/pkg/pracma/man/hessian.html" class="external-link">hessian</a></code> function from the <code>pracma</code> package is used instead for approximating the Hessian. When <em></em>\(\tau^2\) is estimated to be smaller than either <em></em>\(10^{-4}\) or <em></em>\(\min(v_1, \ldots, v_k)/10\) (where <em></em>\(v_i\) denotes the sampling variances of the <em></em>\(i\textrm{th}\) study), then <em></em>\(\tau^2\) is effectively treated as zero for computing the standard errors (which helps to avoid numerical problems in approximating the Hessian). This cutoff can be adjusted via the <code>tau2tol</code> control argument (e.g., <code>control=list(tau2tol=0)</code> to switch off this behavior).</p>
<p>Information on the progress of the optimization algorithm can be obtained by setting <code>verbose=TRUE</code> (this won't work when using parallelization). One can also set <code>verbose</code> to an integer (<code>verbose=2</code> yields even more information and <code>verbose=3</code> also show the progress visually by drawing the selection function as the optimization proceeds).</p>
<p>For selection functions where the <code>prec</code> argument is relevant, using a function of the sample sizes as the measure of precision (i.e., <code>prec="ninv"</code> or <code>prec="sqrtninv"</code>) is only possible when information about the sample sizes is actually stored within the object passed to the <code>selmodel</code> function. That should automatically be the case when the observed effect sizes or outcomes were computed with the <code><a href="escalc.html">escalc</a></code> function or when the observed effect sizes or outcomes were computed within the model fitting function. On the other hand, this will not be the case when <code><a href="rma.uni.html">rma.uni</a></code> was used together with the <code>yi</code> and <code>vi</code> arguments and the <code>yi</code> and <code>vi</code> values were <em>not</em> computed with <code><a href="escalc.html">escalc</a></code>. In that case, it is still possible to pass information about the sample sizes to the <code><a href="rma.uni.html">rma.uni</a></code> function (e.g., use <code>rma.uni(yi, vi, ni=ni, data=dat)</code>, where data frame <code>dat</code> includes a variable called <code>ni</code> with the sample sizes).</p>
<p>Finally, the automatic rescaling of the chosen precision measure can be switched off by setting <code>scaleprec=FALSE</code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Wolfgang Viechtbauer <a href="mailto:wvb@metafor-project.org">wvb@metafor-project.org</a> <a href="https://www.metafor-project.org" class="external-link">https://www.metafor-project.org</a></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Begg, C. B., &amp; Mazumdar, M. (1994). Operating characteristics of a rank correlation test for publication bias. <em>Biometrics</em>, <b>50</b>(4), 1088–1101. <a href="https://doi.org/10.2307/2533446" class="external-link">https://doi.org/10.2307/2533446</a></p>
<p>Carter, E. C., Schönbrodt, F. D., Gervais, W. M., &amp; Hilgard, J. (2019). Correcting for bias in psychology: A comparison of meta-analytic methods. <em>Advances in Methods and Practices in Psychological Science</em>, <b>2</b>(2), 115–144. <a href="https://doi.org/10.1177/2515245919847196" class="external-link">https://doi.org/10.1177/2515245919847196</a></p>
<p>Citkowicz, M., &amp; Vevea, J. L. (2017). A parsimonious weight function for modeling publication bias. <em>Psychological Methods</em>, <b>22</b>(1), 28–41. <a href="https://doi.org/10.1037/met0000119" class="external-link">https://doi.org/10.1037/met0000119</a></p>
<p>Formann, A. K. (2008). Estimating the proportion of studies missing for meta-analysis due to publication bias. <em>Contemporary Clinical Trials</em>, <b>29</b>(5), 732–739. <a href="https://doi.org/10.1016/j.cct.2008.05.004" class="external-link">https://doi.org/10.1016/j.cct.2008.05.004</a></p>
<p>Hedges, L. V. (1992). Modeling publication selection effects in meta-analysis. <em>Statistical Science</em>, <b>7</b>(2), 246–255. <a href="https://doi.org/10.1214/ss/1177011364" class="external-link">https://doi.org/10.1214/ss/1177011364</a></p>
<p>Iyengar, S., &amp; Greenhouse, J. B. (1988). Selection models and the file drawer problem. <em>Statistical Science</em>, <b>3</b>(1), 109–117. <a href="https://doi.org/10.1214/ss/1177013012" class="external-link">https://doi.org/10.1214/ss/1177013012</a></p>
<p>McShane, B. B., Bockenholt, U., &amp; Hansen, K. T. (2016). Adjusting for publication bias in meta-analysis: An evaluation of selection methods and some cautionary notes. <em>Perspectives on Psychological Science</em>, <b>11</b>(5), 730–749. <a href="https://doi.org/10.1177/1745691616662243" class="external-link">https://doi.org/10.1177/1745691616662243</a></p>
<p>Preston, C., Ashby, D., &amp; Smyth, R. (2004). Adjusting for publication bias: Modelling the selection process. <em>Journal of Evaluation in Clinical Practice</em>, <b>10</b>(2), 313–322. <a href="https://doi.org/10.1111/j.1365-2753.2003.00457.x" class="external-link">https://doi.org/10.1111/j.1365-2753.2003.00457.x</a></p>
<p>Pustejovsky, J. E., &amp; Rodgers, M. A. (2019). Testing for funnel plot asymmetry of standardized mean differences. <em>Research Synthesis Methods</em>, <b>10</b>(1), 57–71. <a href="https://doi.org/10.1002/jrsm.1332" class="external-link">https://doi.org/10.1002/jrsm.1332</a></p>
<p>Rust, R. T., Lehmann, D. R. &amp; Farley, J. U. (1990). Estimating publication bias in meta-analysis. <em>Journal of Marketing Research</em>, <b>27</b>(2), 220–226. <a href="https://doi.org/10.1177/002224379002700209" class="external-link">https://doi.org/10.1177/002224379002700209</a></p>
<p>Vevea, J. L., &amp; Hedges, L. V. (1995). A general linear model for estimating effect size in the presence of publication bias. <em>Psychometrika</em>, <b>60</b>(3), 419–435. <a href="https://doi.org/10.1007/BF02294384" class="external-link">https://doi.org/10.1007/BF02294384</a></p>
<p>Vevea, J. L., &amp; Woods, C. M. (2005). Publication bias in research synthesis: Sensitivity analysis using a priori weight functions. <em>Psychological Methods</em>, <b>10</b>(4), 428–443. <a href="https://doi.org/10.1037/1082-989X.10.4.428" class="external-link">https://doi.org/10.1037/1082-989X.10.4.428</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="rma.uni.html">rma.uni</a></code> for the function to fit models which can be extended with selection models.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">############################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### example from Citkowicz and Vevea (2017) for beta selection model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># copy data into 'dat' and examine data</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.baskerville2012.html" class="external-link">dat.baskerville2012</a></span></span></span>
<span class="r-in"><span><span class="va">dat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              author year score design alloconc blind itt fumonths retention country outcomes duration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Kottke et al. 1992     6    cct        0     1   1       19      83.0      US        2       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    McBride et al. 2000     6    rct        0     0   0       18     100.0      US        4       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Stange et al. 2000     6    rct        0     0   0       24        NA      US       35       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       Lobo et al. 2004     6    rct        1     0   0       21      57.0      NL       16       21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Roetzhiem et al. 2005     6   crct        0     1   0       24     100.0      US        3       24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       Hogg et al. 2008     6    cct        0     0   1        6      87.0     Can       26       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       Aspy et al. 2008     6    cct        0     1   0       18      89.0      US        4       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       Jaen et al. 2010     6    rct        0     1   0       26      86.0      US       11       26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Cockburn et al. 1992     7    rct        0     0   0        3      79.0     Aus        2        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Modell et al. 1998     7    rct        0     0   0       12     100.0      UK        1       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Engels et al. 2006     7    rct        1     0   1       12      92.0      NL        7        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      Aspy et al. 2008     7    rct        0     1   0        9     100.0      US        1        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  Deitrich et al. 1992    18    rct        0     1   0       12      96.0      NL       16       21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      Lobo et al. 2002     8    rct        1     0   1       21     100.0      US       10        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     Bryce et al. 1995     9    rct        1     1   1       12      93.3      US        4       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Kinsinger et al. 1998     9    rct        1     1   0       18      94.0      US        5       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   Solberg et al. 1998     9    rct        1     0   1       22     100.0      US       10       22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   Lemelin et al. 2001     9    rct        1     1   0       18      98.0     Can       13       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  Frijling et al. 2002     9   crct        1     1   1       21      95.0      NL        7       21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  Frijling et al. 2003     9   crct        1     1   1       21      95.0      NL       12       21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  Margolis et al. 2004    10    rct        1     1   1       30     100.0      US        4       24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      Mold et al. 2008    10    rct        1     1   1        6     100.0      US        6        6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23      Hogg et al. 2008    12    rct        1     1   1       13     100.0     Can       53       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    pperf meetings hours tailor  smd   se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    5.5     30.0  1.00      1 1.01 0.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     NA      5.0  1.00      1 0.82 0.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   20.0      4.0  1.50      1 0.59 0.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    5.0     15.0  1.00      1 0.44 0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    4.0      4.0  1.00      0 0.84 0.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   11.0     12.0  1.50      1 0.73 0.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    3.0      3.0  6.00      1 1.12 0.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    6.0      4.5  6.00      1 0.04 0.37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   40.0      2.0  0.25      0 0.24 0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  13.0      3.0  1.00      0 0.32 0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    NA      5.0  1.00      1 1.04 0.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   6.0     18.0  6.00      1 1.31 0.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  20.0     15.0  1.00      1 0.59 0.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   8.0      3.0  1.00      1 0.66 0.19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  12.0      1.0 15.00      0 0.62 0.31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  13.0     10.0  0.75      1 0.47 0.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  11.0      4.0  3.00      1 1.08 0.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   8.0     33.0  1.75      1 0.98 0.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  20.0     15.0  1.00      0 0.26 0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  20.0     15.0  1.00      1 0.39 0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  11.0      9.0  1.00      1 0.60 0.31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   8.0     18.0  4.00      1 0.94 0.53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  14.0      9.0  0.75      1 0.11 0.27</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit random-effects model</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.uni.html">rma</a></span><span class="op">(</span><span class="va">smd</span>, <span class="va">se</span><span class="op">^</span><span class="fl">2</span>, data<span class="op">=</span><span class="va">dat</span>, method<span class="op">=</span><span class="st">"ML"</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random-Effects Model (k = 23; tau^2 estimator: ML)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2 (estimated amount of total heterogeneity): 0.016 (SE = 0.024)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau (square root of estimated tau^2 value):      0.127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I^2 (total heterogeneity / total variability):   18.64%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H^2 (total variability / sampling variability):  1.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q(df = 22) = 27.552, p-val = 0.191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate     se   zval   pval  ci.lb  ci.ub      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.555  0.063  8.775  &lt;.001  0.431  0.679  *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># funnel plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="funnel.html">funnel</a></span><span class="op">(</span><span class="va">res</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Standardized Mean Difference"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selmodel-1.png" alt="" width="864" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit beta selection model</span></span></span>
<span class="r-in"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"beta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random-Effects Model (k = 23; tau^2 estimator: ML)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2 (estimated amount of total heterogeneity): 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau (square root of estimated tau^2 value):      0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LRT(df = 1) = 0.009, p-val = 0.925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate     se   zval   pval   ci.lb  ci.ub    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.115  0.166  0.689  0.491  -0.211  0.441    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Selection Model Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LRT(df = 2) = 7.847, p-val = 0.020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selection Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          estimate     se    zval   pval  ci.lb  ci.ub    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta.1     0.473  0.235  -2.240  0.025  0.012  0.934  * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta.2     4.461  2.184   1.585  0.113  0.180  8.742    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the selection function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sel</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selmodel-2.png" alt="" width="864" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit mixed-effects meta-regression model with 'blind' dummy variable as moderator</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.uni.html">rma</a></span><span class="op">(</span><span class="va">smd</span>, <span class="va">se</span><span class="op">^</span><span class="fl">2</span>, data<span class="op">=</span><span class="va">dat</span>, mods <span class="op">=</span> <span class="op">~</span> <span class="va">blind</span>, method<span class="op">=</span><span class="st">"ML"</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixed-Effects Model (k = 23; tau^2 estimator: ML)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2 (estimated amount of residual heterogeneity):     0.016 (SE = 0.024)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau (square root of estimated tau^2 value):             0.128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I^2 (residual heterogeneity / unaccounted variability): 18.26%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H^2 (unaccounted variability / sampling variability):   1.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R^2 (amount of heterogeneity accounted for):            0.00%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Residual Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QE(df = 21) = 27.503, p-val = 0.155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of Moderators (coefficient 2):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QM(df = 1) = 0.069, p-val = 0.792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          estimate     se    zval   pval   ci.lb  ci.ub      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrcpt     0.573  0.093   6.192  &lt;.001   0.392  0.754  *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> blind      -0.033  0.127  -0.263  0.792  -0.282  0.215      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predicted average effect for studies that do not and that do use blinding</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">res</span>, newmods<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    pred    se ci.lb ci.ub pi.lb pi.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.573 0.093 0.392 0.754 0.264 0.882 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.540 0.087 0.370 0.710 0.237 0.842 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit beta selection model</span></span></span>
<span class="r-in"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"beta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixed-Effects Model (k = 23; tau^2 estimator: ML)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2 (estimated amount of residual heterogeneity): 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau (square root of estimated tau^2 value):         0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Residual Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LRT(df = 1) = 0.000, p-val = 1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of Moderators (coefficient 2):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QM(df = 1) = 1.201, p-val = 0.273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          estimate     se    zval   pval   ci.lb  ci.ub    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrcpt     0.134  0.171   0.787  0.431  -0.200  0.469    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> blind      -0.136  0.124  -1.096  0.273  -0.380  0.108    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Selection Model Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LRT(df = 2) = 9.044, p-val = 0.011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selection Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          estimate     se    zval   pval  ci.lb  ci.ub    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta.1     0.420  0.239  -2.425  0.015  0.000  0.889  * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta.2     5.096  2.411   1.699  0.089  0.371  9.821  . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">sel</span>, newmods<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pred    se  ci.lb ci.ub  pi.lb pi.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.134 0.171 -0.200 0.469 -0.200 0.469 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.002 0.199 -0.392 0.388 -0.392 0.388 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### example from Preston et al. (2004)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># copy data into 'dat' and examine data</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.hahn2001.html" class="external-link">dat.hahn2001</a></span></span></span>
<span class="r-in"><span><span class="va">dat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               study ai n1i ci n2i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Banhladesh 1995a  4  19  5  19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Banhladesh 1996a  0  18  0  18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       CHOICE 2001 34 341 50 334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Colombia 2000  7  71 16  69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       Egypt 1886a  6  45  5  44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       Egypt 1996b  1  94  8  96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       India 1984a  0  22  0  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       India 2000b 11  88 12  82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Mexico 1990a  2  82  7  84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      Panama 1982  0  33  0  30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         USA 1982  0  15  1  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         WHO 1995 33 221 43 218</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### meta-analysis of (log) odds rations using the Mantel-Haenszel method</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.mh.html">rma.mh</a></span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OR"</span>, ai<span class="op">=</span><span class="va">ai</span>, n1i<span class="op">=</span><span class="va">n1i</span>, ci<span class="op">=</span><span class="va">ci</span>, n2i<span class="op">=</span><span class="va">n2i</span>, data<span class="op">=</span><span class="va">dat</span>, digits<span class="op">=</span><span class="fl">2</span>, slab<span class="op">=</span><span class="va">study</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some yi/vi values are NA.</span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Equal-Effects Model (k = 12)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I^2 (total heterogeneity / total variability):  0.00%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H^2 (total variability / sampling variability): 0.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Heterogeneity: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q(df = 8) = 6.53, p-val = 0.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results (log scale):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate    se   zval  pval  ci.lb  ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -0.49  0.14  -3.51  &lt;.01  -0.77  -0.22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results (OR scale):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate  ci.lb  ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.61   0.46   0.80 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Test:    CMH = 12.00, df = 1, p-val &lt; 0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tarone's Test for Heterogeneity: X^2 =  7.58, df = 8, p-val = 0.48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate log odds ratios and corresponding sampling variances</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="escalc.html">escalc</a></span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OR"</span>, ai<span class="op">=</span><span class="va">ai</span>, n1i<span class="op">=</span><span class="va">n1i</span>, ci<span class="op">=</span><span class="va">ci</span>, n2i<span class="op">=</span><span class="va">n2i</span>, data<span class="op">=</span><span class="va">dat</span>, drop00<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               study ai n1i ci n2i      yi     vi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Banhladesh 1995a  4  19  5  19 -0.2921 0.5881 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Banhladesh 1996a  0  18  0  18      NA     NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       CHOICE 2001 34 341 50 334 -0.4635 0.0562 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Colombia 2000  7  71 16  69 -1.0153 0.2399 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       Egypt 1886a  6  45  5  44  0.1823 0.4179 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       Egypt 1996b  1  94  8  96 -2.1347 1.1471 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       India 1984a  0  22  0  22      NA     NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       India 2000b 11  88 12  82 -0.1823 0.2015 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Mexico 1990a  2  82  7  84 -1.2910 0.6683 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      Panama 1982  0  33  0  30      NA     NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         USA 1982  0  15  1  20 -0.8690 2.7825 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         WHO 1995 33 221 43 218 -0.3363 0.0646 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit equal-effects model</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span>, method<span class="op">=</span><span class="st">"EE"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 studies with NAs omitted from model fitting.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predicted odds ratio (with 95% CI)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">res</span>, transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.63  0.48  0.83 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># funnel plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="funnel.html">funnel</a></span><span class="op">(</span><span class="va">res</span>, atransf<span class="op">=</span><span class="va">exp</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selmodel-3.png" alt="" width="864" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit half-normal, negative-exponential, logistic, and power selection models</span></span></span>
<span class="r-in"><span><span class="va">sel1</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"halfnorm"</span>, alternative<span class="op">=</span><span class="st">"less"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel2</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"negexp"</span>,   alternative<span class="op">=</span><span class="st">"less"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel3</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"logistic"</span>, alternative<span class="op">=</span><span class="st">"less"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel4</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"power"</span>,    alternative<span class="op">=</span><span class="st">"less"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the selection functions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sel1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sel2</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sel3</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sel4</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add legend</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, inset<span class="op">=</span><span class="fl">0.02</span>, lty<span class="op">=</span><span class="st">"solid"</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"blue"</span>,<span class="st">"red"</span>,<span class="st">"green"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Half-normal"</span>, <span class="st">"Negative-exponential"</span>, <span class="st">"Logistic"</span>, <span class="st">"Power"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selmodel-4.png" alt="" width="864" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show estimates of delta (and corresponding SEs)</span></span></span>
<span class="r-in"><span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sel1</span><span class="op">$</span><span class="va">delta</span>, <span class="va">sel2</span><span class="op">$</span><span class="va">delta</span>, <span class="va">sel3</span><span class="op">$</span><span class="va">delta</span>, <span class="va">sel4</span><span class="op">$</span><span class="va">delta</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  se    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sel1</span><span class="op">$</span><span class="va">se.delta</span>, <span class="va">sel2</span><span class="op">$</span><span class="va">se.delta</span>, <span class="va">sel3</span><span class="op">$</span><span class="va">se.delta</span>, <span class="va">sel4</span><span class="op">$</span><span class="va">se.delta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Half-normal"</span>, <span class="st">"Negative-exponential"</span>, <span class="st">"Logistic"</span>, <span class="st">"Power"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tab</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      delta   se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Half-normal           3.16 2.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Negative-exponential  2.66 2.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Logistic              3.34 2.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power                 1.46 1.39</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predicted odds ratios (with 95% CI)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">res</span>,  transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.63  0.48  0.83 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">sel1</span>, transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.71  0.49  1.04 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">sel2</span>, transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.76  0.48  1.20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">sel3</span>, transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.74  0.49  1.13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">sel4</span>, transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.74  0.49  1.12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit selection models including standard error as precision measure (note: using</span></span></span>
<span class="r-in"><span><span class="co"># scaleprec=FALSE here since Preston et al. (2004) did not use the rescaling)</span></span></span>
<span class="r-in"><span><span class="va">sel1</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"halfnorm"</span>, prec<span class="op">=</span><span class="st">"sei"</span>, alternative<span class="op">=</span><span class="st">"less"</span>, scaleprec<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel2</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"negexp"</span>,   prec<span class="op">=</span><span class="st">"sei"</span>, alternative<span class="op">=</span><span class="st">"less"</span>, scaleprec<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel3</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"logistic"</span>, prec<span class="op">=</span><span class="st">"sei"</span>, alternative<span class="op">=</span><span class="st">"less"</span>, scaleprec<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel4</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"power"</span>,    prec<span class="op">=</span><span class="st">"sei"</span>, alternative<span class="op">=</span><span class="st">"less"</span>, scaleprec<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show estimates of delta (and corresponding SEs)</span></span></span>
<span class="r-in"><span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sel1</span><span class="op">$</span><span class="va">delta</span>, <span class="va">sel2</span><span class="op">$</span><span class="va">delta</span>, <span class="va">sel3</span><span class="op">$</span><span class="va">delta</span>, <span class="va">sel4</span><span class="op">$</span><span class="va">delta</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  se    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sel1</span><span class="op">$</span><span class="va">se.delta</span>, <span class="va">sel2</span><span class="op">$</span><span class="va">se.delta</span>, <span class="va">sel3</span><span class="op">$</span><span class="va">se.delta</span>, <span class="va">sel4</span><span class="op">$</span><span class="va">se.delta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Half-normal"</span>, <span class="st">"Negative-exponential"</span>, <span class="st">"Logistic"</span>, <span class="st">"Power"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tab</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      delta   se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Half-normal           3.51 3.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Negative-exponential  2.28 2.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Logistic              3.02 2.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power                 1.44 1.38</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predicted odds ratio (with 95% CI)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">res</span>,  transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.63  0.48  0.83 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">sel1</span>, transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.68  0.49  0.95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">sel2</span>, transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.69  0.50  0.95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">sel3</span>, transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.68  0.50  0.93 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">sel4</span>, transf<span class="op">=</span><span class="va">exp</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pred ci.lb ci.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.69  0.50  0.96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### meta-analysis on the effect of environmental tobacco smoke on lung cancer risk</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># copy data into 'dat' and examine data</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.hackshaw1998.html" class="external-link">dat.hackshaw1998</a></span></span></span>
<span class="r-in"><span><span class="va">dat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    study       author year   country       design cases   or or.lb or.ub      yi     vi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1    Garfinkel 1981       USA       cohort   153 1.18  0.90  1.54  0.1655 0.0188 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      2     Hirayama 1984     Japan       cohort   200 1.45  1.02  2.08  0.3716 0.0330 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      3       Butler 1988       USA       cohort     8 2.02  0.48  8.56  0.7031 0.5402 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4     Cardenas 1997       USA       cohort   150 1.20  0.80  1.60  0.1823 0.0313 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      5         Chan 1982 Hong Kong case-control    84 0.75  0.43  1.30 -0.2877 0.0797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      6       Correa 1983       USA case-control    22 2.07  0.81  5.25  0.7275 0.2273 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      7 Trichopolous 1983    Greece case-control    62 2.13  1.19  3.83  0.7561 0.0889 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      8      Buffler 1984       USA case-control    41 0.80  0.34  1.90 -0.2231 0.1927 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      9        Kabat 1984       USA case-control    24 0.79  0.25  2.45 -0.2357 0.3390 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    10          Lam 1985 Hong Kong case-control    60 2.01  1.09  3.72  0.6981 0.0981 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    11    Garfinkel 1985       USA case-control   134 1.23  0.81  1.87  0.2070 0.0456 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    12           Wu 1985       USA case-control    29 1.20  0.50  3.30  0.1823 0.2317 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    13        Akiba 1986     Japan case-control    94 1.52  0.87  2.63  0.4187 0.0796 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    14          Lee 1986        UK case-control    32 1.03  0.41  2.55  0.0296 0.2174 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    15          Koo 1987 Hong Kong case-control    86 1.55  0.90  2.67  0.4383 0.0770 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    16    Pershagen 1987    Sweden case-control    70 1.03  0.61  1.74  0.0296 0.0715 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    17       Humble 1987       USA case-control    20 2.34  0.81  6.75  0.8502 0.2926 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    18          Lam 1987 Hong Kong case-control   199 1.65  1.16  2.35  0.5008 0.0324 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    19          Gao 1987     China case-control   246 1.19  0.82  1.73  0.1740 0.0363 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    20     Brownson 1987       USA case-control    19 1.52  0.39  5.96  0.4187 0.4839 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    21         Geng 1988     China case-control    54 2.16  1.08  4.29  0.7701 0.1238 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    22      Shimizu 1988     Japan case-control    90 1.08  0.64  1.82  0.0770 0.0711 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    23        Inoue 1988     Japan case-control    22 2.55  0.74  8.78  0.9361 0.3982 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    24    Kalandidi 1990    Greece case-control    90 1.62  0.90  2.91  0.4824 0.0896 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25    25        Sobue 1990     Japan case-control   144 1.06  0.74  1.52  0.0583 0.0337 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26    26  Wu-Williams 1990     China case-control   417 0.79  0.62  1.02 -0.2357 0.0161 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27    27          Liu 1991     China case-control    54 0.74  0.32  1.69 -0.3011 0.1802 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28    28       Jockel 1991   Germany case-control    23 2.27  0.75  6.82  0.8198 0.3171 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29    29     Brownson 1992       USA case-control   431 0.97  0.78  1.21 -0.0305 0.0125 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30    30    Stockwell 1992       USA case-control   210 1.60  0.80  3.00  0.4700 0.1137 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31    31           Du 1993     China case-control    75 1.19  0.66  2.13  0.1740 0.0893 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32    32          Liu 1993     China case-control    38 1.66  0.73  3.78  0.5068 0.1760 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33    33      Fontham 1994       USA case-control   651 1.26  1.04  1.54  0.2311 0.0100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34    34        Kabat 1995       USA case-control    67 1.10  0.62  1.96  0.0953 0.0862 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35    35      Zaridze 1995    Russia case-control   162 1.66  1.12  2.45  0.5068 0.0399 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36    36          Sun 1996     China case-control   230 1.16  0.80  1.69  0.1484 0.0364 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37    37         Wang 1996     China case-control   135 1.11  0.67  1.84  0.1044 0.0664 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit random-effects model</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span>, method<span class="op">=</span><span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random-Effects Model (k = 37; tau^2 estimator: ML)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2 (estimated amount of total heterogeneity): 0.0204 (SE = 0.0165)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau (square root of estimated tau^2 value):      0.1427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I^2 (total heterogeneity / total variability):   27.62%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H^2 (total variability / sampling variability):  1.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q(df = 36) = 47.4979, p-val = 0.0952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate      se    zval    pval   ci.lb   ci.ub      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.2171  0.0486  4.4712  &lt;.0001  0.1219  0.3123  *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># funnel plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="funnel.html">funnel</a></span><span class="op">(</span><span class="va">res</span>, atransf<span class="op">=</span><span class="va">exp</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selmodel-5.png" alt="" width="864" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># step function selection model</span></span></span>
<span class="r-in"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"stepfun"</span>, alternative<span class="op">=</span><span class="st">"greater"</span>, steps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.025</span>,<span class="fl">.10</span>,<span class="fl">.50</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random-Effects Model (k = 37; tau^2 estimator: ML)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2 (estimated amount of total heterogeneity): 0.0096 (SE = 0.0128)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau (square root of estimated tau^2 value):      0.0981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LRT(df = 1) = 1.1374, p-val = 0.2862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate      se    zval    pval    ci.lb   ci.ub    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0020  0.0889  0.0225  0.9821  -0.1723  0.1763    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Selection Model Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LRT(df = 3) = 6.4020, p-val = 0.0936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selection Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      k  estimate      se      zval    pval   ci.lb   ci.ub      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0     &lt; p &lt;= 0.025   7    1.0000     ---       ---     ---     ---     ---      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.025 &lt; p &lt;= 0.1     8    0.4946  0.3152   -1.6032  0.1089  0.0000  1.1125      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1   &lt; p &lt;= 0.5    16    0.2136  0.1687   -4.6613  &lt;.0001  0.0000  0.5443  *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5   &lt; p &lt;= 1       6    0.0618  0.0689  -13.6177  &lt;.0001  0.0000  0.1969  *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the selection function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sel</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selmodel-6.png" alt="" width="864" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># truncated distribution selection model (with steps=0 by default)</span></span></span>
<span class="r-in"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"trunc"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random-Effects Model (k = 37; tau^2 estimator: ML)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2 (estimated amount of total heterogeneity): 0.0268 (SE = 0.0206)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau (square root of estimated tau^2 value):      0.1636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LRT(df = 1) = 4.8734, p-val = 0.0273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate      se    zval    pval    ci.lb   ci.ub    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.1427  0.0741  1.9267  0.0540  -0.0025  0.2879  . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Selection Model Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LRT(df = 1) = 3.0545, p-val = 0.0805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selection Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate      se     zval    pval   ci.lb   ci.ub     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.3818  0.2236  -2.7652  0.0057  0.0000  0.8200  ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### validity of student ratings example from Vevea &amp; Woods (2005)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># copy data into 'dat' and examine data</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.cohen1981.html" class="external-link">dat.cohen1981</a></span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     study  ni    ri</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Bolton et al. 1979  10  0.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             Bryson 1974  20  0.56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             Centra 1977  13  0.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             Centra 1977  22  0.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Crooks &amp; Smock 1974  28  0.49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Doyle &amp; Crichton 1978  12 -0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Doyle &amp; Whitely 1974  12  0.49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            Elliott 1950  36  0.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    Ellis &amp; Rickard 1977  19  0.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       Frey et al. 1975  12  0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  Greenwood et al. 1976  36 -0.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           Hoffman 1978  75  0.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  McKeachie et al. 1971  33  0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      Morsh et al. 1956 121  0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Remmers et al. 1949  37  0.49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Sullivan &amp; Skanes 1974  14  0.51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Sullivan &amp; Skanes 1974  40  0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Sullivan &amp; Skanes 1974  16  0.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Sullivan &amp; Skanes 1974  14  0.42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20            Wherry 1952  20  0.16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate r-to-z transformed correlations and corresponding sampling variances</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="escalc.html">escalc</a></span><span class="op">(</span>measure<span class="op">=</span><span class="st">"ZCOR"</span>, ri<span class="op">=</span><span class="va">ri</span>, ni<span class="op">=</span><span class="va">ni</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     study  ni    ri      yi     vi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Bolton et al. 1979  10  0.68  0.8291 0.1429 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             Bryson 1974  20  0.56  0.6328 0.0588 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             Centra 1977  13  0.23  0.2342 0.1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             Centra 1977  22  0.64  0.7582 0.0526 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Crooks &amp; Smock 1974  28  0.49  0.5361 0.0400 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Doyle &amp; Crichton 1978  12 -0.04 -0.0400 0.1111 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Doyle &amp; Whitely 1974  12  0.49  0.5361 0.1111 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            Elliott 1950  36  0.33  0.3428 0.0303 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    Ellis &amp; Rickard 1977  19  0.58  0.6625 0.0625 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       Frey et al. 1975  12  0.18  0.1820 0.1111 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  Greenwood et al. 1976  36 -0.11 -0.1104 0.0303 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           Hoffman 1978  75  0.27  0.2769 0.0139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  McKeachie et al. 1971  33  0.26  0.2661 0.0333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      Morsh et al. 1956 121  0.40  0.4236 0.0085 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Remmers et al. 1949  37  0.49  0.5361 0.0294 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Sullivan &amp; Skanes 1974  14  0.51  0.5627 0.0909 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Sullivan &amp; Skanes 1974  40  0.40  0.4236 0.0270 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Sullivan &amp; Skanes 1974  16  0.34  0.3541 0.0769 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Sullivan &amp; Skanes 1974  14  0.42  0.4477 0.0909 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20            Wherry 1952  20  0.16  0.1614 0.0588 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit random-effects model</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span>, method<span class="op">=</span><span class="st">"ML"</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random-Effects Model (k = 20; tau^2 estimator: ML)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2 (estimated amount of total heterogeneity): 0.001 (SE = 0.009)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau (square root of estimated tau^2 value):      0.034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I^2 (total heterogeneity / total variability):   2.86%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H^2 (total variability / sampling variability):  1.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q(df = 19) = 20.974, p-val = 0.338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate     se   zval   pval  ci.lb  ci.ub      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.380  0.045  8.505  &lt;.001  0.292  0.468  *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predicted average correlation (with 95% CI)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.rma.html">predict</a></span><span class="op">(</span><span class="va">res</span>, transf<span class="op">=</span><span class="va">transf.ztor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pred ci.lb ci.ub pi.lb pi.ub </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.363 0.284 0.436 0.263 0.455 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># funnel plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="funnel.html">funnel</a></span><span class="op">(</span><span class="va">res</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="selmodel-7.png" alt="" width="864" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># selection functions from Vevea &amp; Woods (2005)</span></span></span>
<span class="r-in"><span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.35</span>, <span class="fl">0.50</span>, <span class="fl">0.65</span>, <span class="fl">0.75</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="fl">0.995</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   delta.mod.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.99</span>, <span class="fl">0.95</span>, <span class="fl">0.80</span>, <span class="fl">0.75</span>, <span class="fl">0.65</span>, <span class="fl">0.60</span>, <span class="fl">0.55</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   delta.sev.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.99</span>, <span class="fl">0.90</span>, <span class="fl">0.75</span>, <span class="fl">0.60</span>, <span class="fl">0.50</span>, <span class="fl">0.40</span>, <span class="fl">0.35</span>, <span class="fl">0.30</span>, <span class="fl">0.25</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   delta.mod.2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.99</span>, <span class="fl">0.95</span>, <span class="fl">0.90</span>, <span class="fl">0.80</span>, <span class="fl">0.75</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span>, <span class="fl">0.75</span>, <span class="fl">0.80</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="fl">1.00</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   delta.sev.2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.99</span>, <span class="fl">0.90</span>, <span class="fl">0.75</span>, <span class="fl">0.60</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.60</span>, <span class="fl">0.75</span>, <span class="fl">0.90</span>, <span class="fl">0.99</span>, <span class="fl">1.00</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># apply step function model with a priori chosen selection weights</span></span></span>
<span class="r-in"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tab</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">delta</span><span class="op">)</span> <span class="fu">selmodel</span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="st">"stepfun"</span>, steps<span class="op">=</span><span class="va">tab</span><span class="op">$</span><span class="va">steps</span>, delta<span class="op">=</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimates (transformed correlation) and tau^2 values</span></span></span>
<span class="r-in"><span><span class="va">sav</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sel</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  varcomp  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">tau2</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sel</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sav</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             estimate varcomp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.38   0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta.mod.1     0.35   0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta.sev.1     0.32   0.010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta.mod.2     0.36   0.003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta.sev.2     0.33   0.006</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################################################################</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    appId: 'SFWCWKDGL8',
    
    apiKey: 'b56f56470243cf9799f796a3d6ecaedd',
    indexName: 'metafor',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

