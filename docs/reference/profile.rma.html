<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light"><script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Profile Likelihood Plots for 'rma' Objects — profile.rma • metafor</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Profile Likelihood Plots for 'rma' Objects — profile.rma"><meta property="og:description" content='Functions to profile the (restricted) log-likelihood for objects of class "rma.uni", "rma.mv", "rma.uni.selmodel", and "rma.ls". '><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@wviechtb"><meta name="twitter:site" content="@wviechtb"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)"><!-- preferably CSS --><link rel="stylesheet" href="../preferably.css"><link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)"><script src="../darkswitch.js"></script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.3-16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/article/view/v036i03" class="external-link">JSS Article</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
          <a href="#" id="css-toggle-btn">
            <span class="fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        <li>
  <a href="https://twitter.com/wviechtb" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
        
        


      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Profile Likelihood Plots for 'rma' Objects</h1>
    
    <div class="hidden name"><code>profile.rma.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to profile the (restricted) log-likelihood for objects of class <code>"rma.uni"</code>, <code>"rma.mv"</code>, <code>"rma.uni.selmodel"</code>, and <code>"rma.ls"</code>. <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for rma.uni</span></span>
<span><span class="fu">profile</span><span class="op">(</span><span class="va">fitted</span>, <span class="va">xlim</span>, <span class="va">ylim</span>, steps<span class="op">=</span><span class="fl">20</span>,</span>
<span>        lltol<span class="op">=</span><span class="fl">1e-03</span>, progbar<span class="op">=</span><span class="cn">TRUE</span>, parallel<span class="op">=</span><span class="st">"no"</span>, ncpus<span class="op">=</span><span class="fl">1</span>, <span class="va">cl</span>,</span>
<span>        plot<span class="op">=</span><span class="cn">TRUE</span>, pch<span class="op">=</span><span class="fl">19</span>, refline<span class="op">=</span><span class="cn">TRUE</span>, cline<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for rma.mv</span></span>
<span><span class="fu">profile</span><span class="op">(</span><span class="va">fitted</span>, <span class="va">sigma2</span>, <span class="va">tau2</span>, <span class="va">rho</span>, <span class="va">gamma2</span>, <span class="va">phi</span>,</span>
<span>        <span class="va">xlim</span>, <span class="va">ylim</span>, steps<span class="op">=</span><span class="fl">20</span>, lltol<span class="op">=</span><span class="fl">1e-03</span>, progbar<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>        parallel<span class="op">=</span><span class="st">"no"</span>, ncpus<span class="op">=</span><span class="fl">1</span>, <span class="va">cl</span>,</span>
<span>        plot<span class="op">=</span><span class="cn">TRUE</span>, pch<span class="op">=</span><span class="fl">19</span>, refline<span class="op">=</span><span class="cn">TRUE</span>, cline<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for rma.uni.selmodel</span></span>
<span><span class="fu">profile</span><span class="op">(</span><span class="va">fitted</span>, <span class="va">tau2</span>, <span class="va">delta</span>,</span>
<span>        <span class="va">xlim</span>, <span class="va">ylim</span>, steps<span class="op">=</span><span class="fl">20</span>, lltol<span class="op">=</span><span class="fl">1e-03</span>, progbar<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>        parallel<span class="op">=</span><span class="st">"no"</span>, ncpus<span class="op">=</span><span class="fl">1</span>, <span class="va">cl</span>,</span>
<span>        plot<span class="op">=</span><span class="cn">TRUE</span>, pch<span class="op">=</span><span class="fl">19</span>, refline<span class="op">=</span><span class="cn">TRUE</span>, cline<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for rma.ls</span></span>
<span><span class="fu">profile</span><span class="op">(</span><span class="va">fitted</span>, <span class="va">alpha</span>, <span class="va">xlim</span>, <span class="va">ylim</span>, steps<span class="op">=</span><span class="fl">20</span>,</span>
<span>        lltol<span class="op">=</span><span class="fl">1e-03</span>, progbar<span class="op">=</span><span class="cn">TRUE</span>, parallel<span class="op">=</span><span class="st">"no"</span>, ncpus<span class="op">=</span><span class="fl">1</span>, <span class="va">cl</span>,</span>
<span>        plot<span class="op">=</span><span class="cn">TRUE</span>, pch<span class="op">=</span><span class="fl">19</span>, refline<span class="op">=</span><span class="cn">TRUE</span>, cline<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for profile.rma</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for profile.rma</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">xlim</span>, <span class="va">ylim</span>, pch<span class="op">=</span><span class="fl">19</span>,</span>
<span>     <span class="va">xlab</span>, <span class="va">ylab</span>, <span class="va">main</span>, refline<span class="op">=</span><span class="cn">TRUE</span>, cline<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fitted</dt>
<dd><p>an object of class <code>"rma.uni"</code>, <code>"rma.mv"</code>, <code>"rma.uni.selmodel"</code>, or <code>"rma.ls"</code>.</p></dd>

   <dt>x</dt>
<dd><p>an object of class <code>"profile.rma"</code> (for <code>plot</code> and <code>print</code>).</p></dd>

   <dt>sigma2</dt>
<dd><p>optional integer to specify for which <em></em>\(\sigma^2\) value the likelihood should be profiled.</p></dd>

   <dt>tau2</dt>
<dd><p>optional integer to specify for which <em></em>\(\tau^2\) value the likelihood should be profiled.</p></dd>

   <dt>rho</dt>
<dd><p>optional integer to specify for which <em></em>\(\rho\) value the likelihood should be profiled.</p></dd>

   <dt>gamma2</dt>
<dd><p>optional integer to specify for which <em></em>\(\gamma^2\) value the likelihood should be profiled.</p></dd>

   <dt>phi</dt>
<dd><p>optional integer to specify for which <em></em>\(\phi\) value the likelihood should be profiled.</p></dd>

   <dt>delta</dt>
<dd><p>optional integer to specify for which <em></em>\(\delta\) value the likelihood should be profiled.</p></dd>

   <dt>alpha</dt>
<dd><p>optional integer to specify for which <em></em>\(\alpha\) value the likelihood should be profiled.</p></dd>

   <dt>xlim</dt>
<dd><p>optional vector to specify the lower and upper limit of the parameter over which the profiling should be done. If unspecified, the function sets these limits automatically.</p></dd>

   <dt>ylim</dt>
<dd><p>optional vector to specify the y-axis limits when plotting the profiled likelihood. If unspecified, the function sets these limits automatically.</p></dd>

   <dt>steps</dt>
<dd><p>number of points between <code>xlim[1]</code> and <code>xlim[2]</code> (inclusive) for which the likelihood should be evaluated (the default is 20).</p></dd>

   <dt>lltol</dt>
<dd><p>numerical tolerance used when comparing values of the profiled log-likelihood with the log-likelihood of the fitted model (the default is 1e-03).</p></dd>

   <dt>progbar</dt>
<dd><p>logical to specify whether a progress bar should be shown (the default is <code>TRUE</code>).</p></dd>

   <dt>parallel</dt>
<dd><p>character string to specify whether parallel processing should be used (the default is <code>"no"</code>). For parallel processing, set to either <code>"snow"</code> or <code>"multicore"</code>. See ‘Details’.</p></dd>

   <dt>ncpus</dt>
<dd><p>integer to specify the number of processes to use in the parallel processing.</p></dd>

   <dt>cl</dt>
<dd><p>optional cluster to use if <code>parallel="snow"</code>. If unspecified, a cluster on the local machine is created for the duration of the call.</p></dd>

   <dt>plot</dt>
<dd><p>logical to specify whether the profile plot should be drawn after profiling is finished (the default is <code>TRUE</code>).</p></dd>

   <dt>pch</dt>
<dd><p>plotting symbol to use. By default, a filled circle is used. See <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></code> for other options.</p></dd>

   <dt>refline</dt>
<dd><p>logical to specify whether the value of the parameter estimate should be indicated by a dotted vertical line and its log-likelihood value by a dotted horizontal line (the default is <code>TRUE</code>).</p></dd>

   <dt>cline</dt>
<dd><p>logical to specify whether a horizontal reference line should be added to the plot that indicates the log-likelihood value corresponding to the 95% profile confidence interval (the default is <code>FALSE</code>).</p></dd>

   <dt>xlab</dt>
<dd><p>title for the x-axis. If unspecified, the function sets an appropriate axis title.</p></dd>

   <dt>ylab</dt>
<dd><p>title for the y-axis. If unspecified, the function sets an appropriate axis title.</p></dd>

   <dt>main</dt>
<dd><p>title for the plot. If unspecified, the function sets an appropriate title.</p></dd>

   <dt>...</dt>
<dd><p>other arguments.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function fixes a particular parameter of the model and then computes the maximized (restricted) log-likelihood over the remaining parameters of the model. By doing this for a range of values for the parameter that was fixed, a profile of the (restricted) log-likelihood is constructed.</p>
<p></p><div class="section">
<h3 id="selecting-the-parameter-s-to-profile">Selecting the Parameter(s) to Profile<a class="anchor" aria-label="anchor" href="#selecting-the-parameter-s-to-profile"></a></h3>


<p>The parameters that can be profiled depend on the model object:</p><ul><li><p>For objects of class <code>"rma.uni"</code> obtained with the <code><a href="rma.uni.html">rma.uni</a></code> function, the function profiles over <em></em>\(\tau^2\) (not for equal-effects models).</p></li>
<li><p>For objects of class <code>"rma.mv"</code> obtained with the <code><a href="rma.mv.html">rma.mv</a></code> function, profiling is done by default over all (non-fixed) variance and correlation components of the model. Alternatively, one can use the <code>sigma2</code>, <code>tau2</code>, <code>rho</code>, <code>gamma2</code>, or <code>phi</code> arguments to specify over which parameter the profiling should be done. Only one of these arguments can be used at a time. A single integer is used to specify the number of the parameter.</p></li>
<li><p>For selection model objects of class <code>"rma.uni.selmodel"</code> obtained with the <code><a href="selmodel.html">selmodel</a></code> function, profiling is done by default over <em></em>\(\tau^2\) (for models where this is an estimated parameter) and all (non-fixed) selection model parameters. Alternatively, one can choose to profile only <em></em>\(\tau^2\) by setting <code>tau2=TRUE</code> or one can select one of the selection model parameters to profile by specifying its number via the <code>delta</code> argument.</p></li>
<li><p>For location-scale model objects of class <code>"rma.ls"</code> obtained with the <code><a href="rma.uni.html">rma.uni</a></code> function, profiling is done by default over all (non-fixed) <em></em>\(\alpha\) parameters that are part of the scale model.</p></li>
</ul><p></p>
</div>

<p></p><div class="section">
<h3 id="interpreting-a-likelihood-profile">Interpreting a Likelihood Profile<a class="anchor" aria-label="anchor" href="#interpreting-a-likelihood-profile"></a></h3>


<p>A profile plot should show a single peak at the corresponding ML/REML estimate (assuming that the model was fitted with ML/REML estimation). If <code>refline=TRUE</code> (the default), the value of the parameter estimate is indicated by a dotted vertical line and its log-likelihood value by a dotted horizontal line. Hence, the intersection of these two lines should correspond to the peak.</p>
<p>When profiling a variance component (or some other parameter that cannot be negative), the peak may be at zero (if this corresponds to the ML/REML estimate of the parameter). In this case, the profiled log-likelihood should be a monotonically decreasing function of the parameter.</p>
<p>If the profiled log-likelihood has multiple peaks, this indicates that the likelihood surface is not unimodal. In such cases, the ML/REML estimate may correspond to a local optimum (when the intersection of the two dotted lines is not at the highest peak).</p>
<p>If the profile is flat (over the entire parameter space or large portions of it), then this suggests that at least some of the parameters of the model are not identifiable (and the parameter estimates obtained are to some extent arbitrary). See Raue et al. (2009) for some further discussion of parameter identifiability (structurally and practically) and the use of profile likelihoods to check for this.</p>
<p>The function checks whether any profiled log-likelihood value is actually larger than the log-likelihood of the fitted model (using a numerical tolerance of <code>lltol</code>). If so, a warning is issued as this might indicate that the optimizer did not identify the actual ML/REML estimate.</p>
<p></p>
</div>

<p></p><div class="section">
<h3 id="parallel-processing">Parallel Processing<a class="anchor" aria-label="anchor" href="#parallel-processing"></a></h3>


<p>Profiling requires repeatedly refitting the model, which can be slow when <em></em>\(k\) is large and/or the model is complex (the latter especially applies to <code>"rma.mv"</code> objects and also to certain <code>"rma.uni.selmodel"</code> or <code>"rma.ls"</code> objects). On machines with multiple cores, one can try to speed things up by delegating the model fitting to separate worker processes, that is, by setting <code>parallel="snow"</code> or <code>parallel="multicore"</code> and <code>ncpus</code> to some value larger than 1. Parallel processing makes use of the <code><a href="https://rdrr.io/r/parallel/parallel-package.html" class="external-link">parallel</a></code> package, using the <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makePSOCKcluster</a></code> and <code><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parLapply</a></code> functions when <code>parallel="snow"</code> or using <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></code> when <code>parallel="multicore"</code> (the latter only works on Unix/Linux-alikes). With <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>, one can check on the number of available cores on the local machine.</p>
<p></p>
</div>


    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>"profile.rma"</code>. The object is a list (or list of such lists) containing the following components:</p>


<p>One of the following (depending on the parameter that was actually profiled):</p>
<dl><dt>sigma2</dt>
<dd><p>values of <em></em>\(\sigma^2\) over which the likelihood was profiled.</p></dd>

   <dt>tau2</dt>
<dd><p>values of <em></em>\(\tau^2\) over which the likelihood was profiled.</p></dd>

   <dt>rho</dt>
<dd><p>values of <em></em>\(\rho\) over which the likelihood was profiled.</p></dd>

   <dt>gamma2</dt>
<dd><p>values of <em></em>\(\gamma^2\) over which the likelihood was profiled.</p></dd>

   <dt>phi</dt>
<dd><p>values of <em></em>\(\phi\) over which the likelihood was profiled.</p></dd>

   <dt>delta</dt>
<dd><p>values of <em></em>\(\delta\) over which the likelihood was profiled.</p></dd>

   <dt>alpha</dt>
<dd><p>values of <em></em>\(\alpha\) over which the likelihood was profiled.</p></dd>


</dl><p>In addition, the following components are included:</p>
<dl><dt>ll</dt>
<dd><p>(restricted) log-likelihood values at the corresponding parameter values.</p></dd>

   <dt>beta</dt>
<dd><p>a matrix with the estimated model coefficients at the corresponding parameter values.</p></dd>

   <dt>ci.lb</dt>
<dd><p>a matrix with the lower confidence interval bounds of the model coefficients at the corresponding parameter values.</p></dd>

   <dt>ci.ub</dt>
<dd><p>a matrix with the upper confidence interval bounds of the model coefficients at the corresponding parameter values.</p></dd>

   <dt>...</dt>
<dd><p>some additional elements/values.</p></dd>

</dl><p>Note that the list is returned invisibly.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Wolfgang Viechtbauer <a href="mailto:wvb@metafor-project.org">wvb@metafor-project.org</a> <a href="https://www.metafor-project.org" class="external-link">https://www.metafor-project.org</a></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Raue, A., Kreutz, C., Maiwald, T., Bachmann, J., Schilling, M., Klingmuller, U., &amp; Timmer, J. (2009). Structural and practical identifiability analysis of partially observed dynamical models by exploiting the profile likelihood. <em>Bioinformatics</em>, <b>25</b>(15), 1923–1929. <a href="https://doi.org/10.1093/bioinformatics/btp358" class="external-link">https://doi.org/10.1093/bioinformatics/btp358</a></p>
<p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1–48. <a href="https://doi.org/10.18637/jss.v036.i03" class="external-link">https://doi.org/10.18637/jss.v036.i03</a></p>
<p>Viechtbauer, W., &amp; López-López, J. A. (2022). Location-scale models for meta-analysis. <em>Research Synthesis Methods</em>. <b>13</b>(6), 697–715. <a href="https://doi.org/10.1002/jrsm.1562" class="external-link">https://doi.org/10.1002/jrsm.1562</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="rma.uni.html">rma.uni</a></code>, <code><a href="rma.mv.html">rma.mv</a></code>, and <code><a href="selmodel.html">selmodel</a></code> for functions to fit models for which profile likelihood plots can be drawn.</p>
<p><code><a href="confint.rma.html">confint</a></code> for functions to compute corresponding profile likelihood confidence intervals.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### calculate log odds ratios and corresponding sampling variances</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="escalc.html">escalc</a></span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OR"</span>, ai<span class="op">=</span><span class="va">tpos</span>, bi<span class="op">=</span><span class="va">tneg</span>, ci<span class="op">=</span><span class="va">cpos</span>, di<span class="op">=</span><span class="va">cneg</span>, data<span class="op">=</span><span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.bcg.html" class="external-link">dat.bcg</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### fit random-effects model using rma.uni()</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### profile over tau^2</span></span></span>
<span class="r-in"><span><span class="fu">profile</span><span class="op">(</span><span class="va">res</span>, progbar<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="profile.rma-1.png" alt="" width="864" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### change data into long format</span></span></span>
<span class="r-in"><span><span class="va">dat.long</span> <span class="op">&lt;-</span> <span class="fu"><a href="to.long.html">to.long</a></span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OR"</span>, ai<span class="op">=</span><span class="va">tpos</span>, bi<span class="op">=</span><span class="va">tneg</span>, ci<span class="op">=</span><span class="va">cpos</span>, di<span class="op">=</span><span class="va">cneg</span>, data<span class="op">=</span><span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.bcg.html" class="external-link">dat.bcg</a></span>, append<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### set levels of group variable ("exp" = experimental/vaccinated; "con" = control/non-vaccinated)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">dat.long</span><span class="op">$</span><span class="va">group</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"con"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### set "con" to reference level</span></span></span>
<span class="r-in"><span><span class="va">dat.long</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></span><span class="op">(</span><span class="va">dat.long</span><span class="op">$</span><span class="va">group</span>, ref<span class="op">=</span><span class="st">"con"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### calculate log odds and corresponding sampling variances</span></span></span>
<span class="r-in"><span><span class="va">dat.long</span> <span class="op">&lt;-</span> <span class="fu"><a href="escalc.html">escalc</a></span><span class="op">(</span>measure<span class="op">=</span><span class="st">"PLO"</span>, xi<span class="op">=</span><span class="va">out1</span>, mi<span class="op">=</span><span class="va">out2</span>, data<span class="op">=</span><span class="va">dat.long</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat.long</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    study group out1  out2      yi     vi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1   con    4   119 -3.3928 0.2584 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1   exp   11   128 -2.4541 0.0987 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      2   con    6   300 -3.9120 0.1700 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      2   exp   29   274 -2.2458 0.0381 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      3   con    3   228 -4.3307 0.3377 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      3   exp   11   209 -2.9444 0.0957 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      4   con   62 13536 -5.3860 0.0162 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      4   exp  248 12619 -3.9295 0.0041 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      5   con   33  5036 -5.0279 0.0305 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     5   exp   47  5761 -4.8087 0.0215 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     6   con  180  1361 -2.0230 0.0063 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     6   exp  372  1079 -1.0649 0.0036 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     7   con    8  2537 -5.7593 0.1254 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     7   exp   10   619 -4.1255 0.1016 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     8   con  505 87886 -5.1592 0.0020 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     8   exp  499 87892 -5.1713 0.0020 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     9   con   29  7470 -5.5514 0.0346 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     9   exp   45  7232 -5.0796 0.0224 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    10   con   17  1699 -4.6046 0.0594 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    10   exp   65  1600 -3.2034 0.0160 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    11   con  186 50448 -5.6030 0.0054 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    11   exp  141 27197 -5.2621 0.0071 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    12   con    5  2493 -6.2118 0.2004 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    12   exp    3  2338 -6.6584 0.3338 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25    13   con   27 16886 -6.4384 0.0371 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26    13   exp   29 17825 -6.4211 0.0345 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### fit bivariate random-effects model using rma.mv()</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.mv.html">rma.mv</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, mods <span class="op">=</span> <span class="op">~</span> <span class="va">group</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">group</span> <span class="op">|</span> <span class="va">study</span>, struct<span class="op">=</span><span class="st">"UN"</span>, data<span class="op">=</span><span class="va">dat.long</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate Meta-Analysis Model (k = 26; method: REML)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance Components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer factor: study (nlvls = 13)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> inner factor: group (nlvls = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             estim    sqrt  k.lvl  fixed  level </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2.1    1.5486  1.2444     13     no    con </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau^2.2    2.6173  1.6178     13     no    exp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      rho.con  rho.exp    con  exp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> con        1               -   13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> exp   0.9450        1     no    - </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Residual Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QE(df = 24) = 5270.3863, p-val &lt; .0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of Moderators (coefficient 2):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> QM(df = 1) = 15.5470, p-val &lt; .0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           estimate      se      zval    pval    ci.lb    ci.ub      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intrcpt    -4.8374  0.3528  -13.7113  &lt;.0001  -5.5289  -4.1459  *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> groupexp    0.7414  0.1880    3.9430  &lt;.0001   0.3729   1.1099  *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### profile over tau^2_1, tau^2_2, and rho</span></span></span>
<span class="r-in"><span><span class="co">### note: for rho, adjust region over which profiling is done ('zoom in' on area around estimate)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">profile</span><span class="op">(</span><span class="va">res</span>, tau2<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">profile</span><span class="op">(</span><span class="va">res</span>, tau2<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">profile</span><span class="op">(</span><span class="va">res</span>, rho<span class="op">=</span><span class="fl">1</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.90</span>, <span class="fl">0.98</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### an example where the peak of the likelihood profile is at 0</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="escalc.html">escalc</a></span><span class="op">(</span>measure<span class="op">=</span><span class="st">"RD"</span>, n1i<span class="op">=</span><span class="va">n1i</span>, n2i<span class="op">=</span><span class="va">n2i</span>, ai<span class="op">=</span><span class="va">ai</span>, ci<span class="op">=</span><span class="va">ci</span>, data<span class="op">=</span><span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.hine1989.html" class="external-link">dat.hine1989</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="profile.rma-2.png" alt="" width="864" height="768"></span>
<span class="r-in"><span><span class="fu">profile</span><span class="op">(</span><span class="va">res</span>, progbar<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="profile.rma-3.png" alt="" width="864" height="768"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    appId: 'SFWCWKDGL8',
    
    apiKey: 'b56f56470243cf9799f796a3d6ecaedd',
    indexName: 'metafor',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

