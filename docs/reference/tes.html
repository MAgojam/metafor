<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light"><script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Test of Excess Significance — tes • metafor</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Test of Excess Significance — tes"><meta property="og:description" content="Function to conduct the test of excess significance. "><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@wviechtb"><meta name="twitter:site" content="@wviechtb"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)"><!-- preferably CSS --><link rel="stylesheet" href="../preferably.css"><link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)"><script src="../darkswitch.js"></script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1-58</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/article/view/v036i03" class="external-link">JSS Article</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
          <a href="#" id="css-toggle-btn">
            <span class="fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        <li>
  <a href="https://twitter.com/wviechtb" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
        
        


      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test of Excess Significance</h1>
    
    <div class="hidden name"><code>tes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to conduct the test of excess significance. <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">tes</span><span class="op">(</span><span class="va">x</span>, <span class="va">vi</span>, <span class="va">sei</span>, <span class="va">subset</span>, <span class="va">data</span>, H0<span class="op">=</span><span class="fl">0</span>, alternative<span class="op">=</span><span class="st">"two.sided"</span>, alpha<span class="op">=</span><span class="fl">.05</span>, <span class="va">theta</span>, <span class="va">tau2</span>,
    <span class="va">test</span>, tes.alternative<span class="op">=</span><span class="st">"greater"</span>, progbar<span class="op">=</span><span class="cn">TRUE</span>, tes.alpha<span class="op">=</span><span class="fl">.10</span>, <span class="va">digits</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for tes</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">digits</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p><em>These arguments pertain to data input:</em></p>
<dl><dt>x</dt>
<dd><p>a vector with the observed effect sizes or outcomes or an object of class <code>"rma"</code>.</p></dd>
<dt>vi</dt>
<dd><p>vector with the corresponding sampling variances (ignored if <code>x</code> is an object of class <code>"rma"</code>).</p></dd>
<dt>sei</dt>
<dd><p>vector with the corresponding standard errors (note: only one of the two, <code>vi</code> or <code>sei</code>, needs to be specified).</p></dd>
<dt>subset</dt>
<dd><p>optional (logical or numeric) vector to specify the subset of studies that should be included (ignored if <code>x</code> is an object of class <code>"rma"</code>).</p></dd>
<dt>data</dt>
<dd><p>optional data frame containing the variables given to the arguments above.</p></dd>
</dl><p><em>These arguments pertain to the tests of the observed effect sizes or outcomes:</em></p>
<dl><dt>H0</dt>
<dd><p>numeric value to specify the value of the effect size or outcome under the null hypothesis (the default is 0).</p></dd>
<dt>alternative</dt>
<dd><p>character string to specify the sidedness of the hypothesis when testing the observed effect sizes or outcomes. Possible options are <code>"two.sided"</code> (the default), <code>"greater"</code>, or <code>"less"</code>. Can be abbreviated.</p></dd>
<dt>alpha</dt>
<dd><p>alpha level for testing the observed effect sizes or outcomes (the default is .05).</p></dd>
</dl><p><em>These arguments pertain to the power of the tests:</em></p>
<dl><dt>theta</dt>
<dd><p>optional numeric value to specify the value of the true effect size or outcome under the alternative hypothesis. If unspecified, it will be estimated based on the data or the value is taken from the <code>"rma"</code> object.</p></dd>
<dt>tau2</dt>
<dd><p>optional numeric value to specify the amount of heterogeneity in the true effect sizes or outcomes. If unspecified, the true effect sizes or outcomes are assumed to be homogeneous or the value is taken from the <code>"rma"</code> object.</p></dd>
</dl><p><em>These arguments pertain to the test of excess significance:</em></p>
<dl><dt>test</dt>
<dd><p>optional character string to specify the type of test to use for conducting the test of excess significance. Possible options are <code>"chi2"</code>, <code>"binom"</code>, or <code>"exact"</code>. Can be abbreviated. If unspecified, the function chooses the type of test based on the data.</p></dd>
<dt>tes.alternative</dt>
<dd><p>character string to specify the sidedness of the hypothesis for the test of excess significance. Possible options are <code>"greater"</code> (the default), <code>"two.sided"</code>, or <code>"less"</code>. Can be abbreviated.</p></dd>
<dt>progbar</dt>
<dd><p>logical to specify whether a progress bar should be shown (the default is <code>TRUE</code>). Only relevant when conducting an exact test.</p></dd>
<dt>tes.alpha</dt>
<dd><p>alpha level for the test of excess significance (the default is .10). Only relevant for finding the ‘limit estimate’.</p></dd>
</dl><p><em>Miscellaneous arguments:</em></p>
<dl><dt>digits</dt>
<dd><p>optional integer to specify the number of decimal places to which the printed results should be rounded.</p></dd>
<dt>...</dt>
<dd><p>other arguments.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function carries out the test of excess significance described by Ioannidis and Trikalinos (2007). The test can be used to examine whether the observed number of significant findings is greater than the number of significant findings expected given the power of the tests. An overabundance of significant tests may suggest that the collection of studies is not representative of all studies conducted on a particular topic.</p>
<p>One can either pass a vector with the observed effect sizes or outcomes (via <code>x</code>) and the corresponding sampling variances via <code>vi</code> (or the standard errors via <code>sei</code>) to the function or an object of class <code>"rma"</code>.</p>
<p>The observed effect sizes or outcomes are tested for significance based on a standard Wald-type test, that is, by comparing \[z_i = \frac{y_i - \mbox{H}_0}{\sqrt{v_i}}\] against the appropriate critical value(s) of a standard normal distribution (e.g., <em></em>\(\pm 1.96\) for <code>alternative="two.sided"</code> and <code>alpha=.05</code>, which are the defaults). Let <em></em>\(O\) denote the observed number of significant tests.</p>
<p>Given a particular value for the true effect or outcome denoted by <em></em>\(\theta\) (which, if it is unspecified, is determined by computing the inverse-variance weighted average of the observed effect sizes or outcomes or the value is taken from the model object), let <em></em>\(1-\beta_i\) denote the power of the <em></em>\(i\textrm{th}\) test (where <em></em>\(\beta_i\) denotes the Type II error probability). If <em></em>\(\tau^2 &gt; 0\), let <em></em>\(1-\beta_i\) denote the expected power (computed based on integrating the power over a normal distribution with mean <em></em>\(\theta\) and variance <em></em>\(\tau^2\)). Let <em></em>\(E = \sum_{i=1}^k (1-\beta_i)\) denote the expected number of significant tests.</p>
<p>The test of excess significance then tests if <em></em>\(O\) is significantly greater (if <code>tes.alternative="greater"</code>) than <em></em>\(E\). This can be done using Pearson's chi-squared test (if <code>test="chi2"</code>), a binomial test (if <code>test="binomial"</code>), or an exact test (if <code>test="exact"</code>). The latter is described in Francis (2013). If argument <code>test</code> is unspecified, the default is to do an exact test if the number of elements in the sum that needs to be computed is less than or equal to <code>10^6</code> and to do a chi-square test otherwise.</p>
<p>One can also iteratively find the value of <em></em>\(\theta\) such that the p-value of the test of excess significance is equal to <code>tes.alpha</code> (which is <code>.10</code> by default). The resulting value is called the ‘limit estimate’ and is denoted <em></em>\(\theta_{lim}\) by Ioannidis and Trikalinos (2007). Note that the limit estimate is not computable if the p-value is larger than <code>tes.alpha</code> even if <em></em>\(\theta = \mbox{H}_0\).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>"tes"</code>. The object is a list containing the following components:</p>
<dl><dt>k</dt>
<dd><p>the number of studies included in the analysis.</p></dd>
<dt>O</dt>
<dd><p>the observed number of significant tests.</p></dd>
<dt>E</dt>
<dd><p>the expected number of significant tests.</p></dd>
<dt>OEratio</dt>
<dd><p>the ratio of O over E.</p></dd>
<dt>test</dt>
<dd><p>the type of test conducted.</p></dd>
<dt>pval</dt>
<dd><p>the p-value of the test of excess significance.</p></dd>
<dt>power</dt>
<dd><p>the (estimated) power of the tests.</p></dd>
<dt>sig</dt>
<dd><p>logical vector indicating which tests were significant.</p></dd>
<dt>theta</dt>
<dd><p>the value of <em></em>\(\theta\) used for computing the power of the tests.</p></dd>
<dt>theta.lim</dt>
<dd><p>the ‘limit estimate’ (i.e., <em></em>\(\theta_{lim}\)).</p></dd>
<dt>...</dt>
<dd><p>some additional elements/values.</p></dd>
</dl><p>The results are formatted and printed with the <code>print</code> function.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>When <code>tes.alternative="greater"</code> (the default), then the function tests if <em></em>\(O\) is significantly greater than <em></em>\(E\) and hence this is indeed a test of excess significance. When <code>tes.alternative="two.sided"</code>, then the function tests if <em></em>\(O\) differs significantly from <em></em>\(E\) in either direction and hence it would be more apt to describe this as a test of (in)consistency (between <em></em>\(O\) and <em></em>\(E\)). Finally, one can also set <code>tes.alternative="less"</code>, in which case the function tests if <em></em>\(O\) is significantly lower than <em></em>\(E\), which could be considered a test of excess non-significance.</p>
<p>When <code>tes.alternative="two.sided"</code>, one can actually compute two limit estimates. The function attempts to compute both.</p>
<p>The function computes the significance and power of the studies based on Wald-type tests regardless of the effect size or outcome measure used as input. This works as an adequate approximation as long as the within-study sample sizes are not too small.</p>
<p>Note that the test is not a test for publication bias but a test whether the set of studies includes an unusual number of significant findings given the power of the studies. The general usefulness of the test and its usefulness under particular circumstances (e.g., when there is substantial heterogeneity in the true effect sizes or outcomes) has been the subject of considerable debate. See Francis (2013) and the commentaries on this article in the same issue of the journal.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Wolfgang Viechtbauer <a href="mailto:wvb@metafor-project.org">wvb@metafor-project.org</a> <a href="https://www.metafor-project.org" class="external-link">https://www.metafor-project.org</a></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Francis, G. (2013). Replication, statistical consistency, and publication bias. <em>Journal of Mathematical Psychology</em>, <b>57</b>(5), 153–169. <a href="https://doi.org/10.1016/j.jmp.2013.02.003" class="external-link">https://doi.org/10.1016/j.jmp.2013.02.003</a></p>
<p>Ioannidis, J. P. A., &amp; Trikalinos, T. A. (2007). An exploratory test for an excess of significant findings. <em>Clinical Trials</em>, <b>4</b>(3), 245–253. <a href="https://doi.org/10.1177/1740774507079441" class="external-link">https://doi.org/10.1177/1740774507079441</a></p>
<p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1–48. <a href="https://doi.org/10.18637/jss.v036.i03" class="external-link">https://doi.org/10.18637/jss.v036.i03</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ranktest.html">ranktest</a></code> for the rank test, <code><a href="regtest.html">regtest</a></code> for the regression test, <code><a href="trimfill.html">trimfill</a></code> for the trim and fill method, and <code><a href="selmodel.html">selmodel</a></code> for selection models.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">### calculate log risk ratios and corresponding sampling variances</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="escalc.html">escalc</a></span><span class="op">(</span>measure<span class="op">=</span><span class="st">"RR"</span>, ai<span class="op">=</span><span class="va">x.a</span>, n1i<span class="op">=</span><span class="va">n.a</span>, ci<span class="op">=</span><span class="va">x.p</span>, n2i<span class="op">=</span><span class="va">n.p</span>, data<span class="op">=</span><span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.dorn2007.html" class="external-link">dat.dorn2007</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### conduct test of excess significance (using test="chi2" to speed things up)</span></span>
<span class="r-in"><span class="fu">tes</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span>, test<span class="op">=</span><span class="st">"chi2"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of Excess Significance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed Number of Significant Findings: 10 (out of 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Number of Significant Findings: 4.9233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed Number / Expected Number:       2.0311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Power of Tests (based on theta = 0.3123)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    min      q1  median      q3     max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0894  0.1270  0.2118  0.3537  0.5397 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of Excess Significance: p = 0.0039 (X^2 = 7.0656, df = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Limit Estimate (theta_lim):  0.4062 (where p = 0.1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### same as fitting an EE model and then passing the object to the function</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span>, method<span class="op">=</span><span class="st">"EE"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">tes</span><span class="op">(</span><span class="va">res</span>, test<span class="op">=</span><span class="st">"chi2"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of Excess Significance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed Number of Significant Findings: 10 (out of 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Number of Significant Findings: 4.9233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed Number / Expected Number:       2.0311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Power of Tests (based on theta = 0.3123)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    min      q1  median      q3     max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0894  0.1270  0.2118  0.3537  0.5397 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of Excess Significance: p = 0.0039 (X^2 = 7.0656, df = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Limit Estimate (theta_lim):  0.4062 (where p = 0.1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### illustrate limit estimate (value of theta where p-value of test is equal to tes.alpha)</span></span>
<span class="r-in"><span class="va">thetas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length<span class="op">=</span><span class="fl">101</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">thetas</span>, <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="fu">tes</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span>, test<span class="op">=</span><span class="st">"chi2"</span>, theta<span class="op">=</span><span class="va">theta</span><span class="op">)</span><span class="op">$</span><span class="va">pval</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">thetas</span>, <span class="va">pvals</span>, type<span class="op">=</span><span class="st">"o"</span>, pch<span class="op">=</span><span class="fl">19</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sav</span> <span class="op">&lt;-</span> <span class="fu">tes</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span>, test<span class="op">=</span><span class="st">"chi2"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">sav</span><span class="op">$</span><span class="va">tes.alpha</span>, lty<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">sav</span><span class="op">$</span><span class="va">theta.lim</span>, lty<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="tes-1.png" alt="" width="864" height="768"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### examine significance of test as a function of alpha (to examine 'significance chasing')</span></span>
<span class="r-in"><span class="va">alphas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.01</span>,<span class="fl">.99</span>,length<span class="op">=</span><span class="fl">101</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">alphas</span>, <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span> <span class="fu">tes</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data<span class="op">=</span><span class="va">dat</span>, test<span class="op">=</span><span class="st">"chi2"</span>, alpha<span class="op">=</span><span class="va">alpha</span><span class="op">)</span><span class="op">$</span><span class="va">pval</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">alphas</span>, <span class="va">pvals</span>, type<span class="op">=</span><span class="st">"o"</span>, pch<span class="op">=</span><span class="fl">19</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">.05</span>, lty<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">.10</span>, lty<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="tes-2.png" alt="" width="864" height="768"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    appId: 'SFWCWKDGL8',
    
    apiKey: 'b56f56470243cf9799f796a3d6ecaedd',
    indexName: 'metafor',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

