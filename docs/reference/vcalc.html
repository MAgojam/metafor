<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. -->
<meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script>

<title>Construct or Approximate the Variance-Covariance Matrix of Dependent Effect Sizes or Outcomes — vcalc • metafor</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- Flatly Theme - Light  -->
<link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">

<!-- Darkly Theme - Dark -->
<link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">

<!-- preferably CSS -->
<link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">

  <script src="../darkswitch.js"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Construct or Approximate the Variance-Covariance Matrix of Dependent Effect Sizes or Outcomes — vcalc" />
<meta property="og:description" content="The function can be used to construct or approximate the variance-covariance matrix of dependent effect sizes or outcomes, or more precisely, of their sampling errors (i.e., the V matrix in rma.mv). " />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@wviechtb" />
<meta name="twitter:site" content="@wviechtb" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>




<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1-20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/index.php/jss/article/view/v036i03/v36i03.pdf">JSS Article (pdf)</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
        <li>
          <a href="#" id="css-toggle-btn">
            <span class="fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        <li>
  <a href="https://twitter.com/wviechtb">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor">
    <span class="fa fa-github"></span>
     
  </a>
</li>
        
        


      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct or Approximate the Variance-Covariance Matrix of Dependent Effect Sizes or Outcomes</h1>
    
    <div class="hidden name"><code>vcalc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function can be used to construct or approximate the variance-covariance matrix of dependent effect sizes or outcomes, or more precisely, of their sampling errors (i.e., the <code>V</code> matrix in <code><a href='rma.mv.html'>rma.mv</a></code>). <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <pre class="usage"><span class='fu'>vcalc</span><span class='op'>(</span><span class='va'>vi</span>, <span class='va'>cluster</span>, <span class='va'>subgroup</span>, <span class='va'>obs</span>, <span class='va'>type</span>, <span class='va'>time1</span>, <span class='va'>time2</span>, <span class='va'>grp1</span>, <span class='va'>grp2</span>, <span class='va'>w1</span>, <span class='va'>w2</span>,
      <span class='va'>data</span>, <span class='va'>rho</span>, <span class='va'>phi</span>, <span class='va'>rvars</span>, checkpd<span class='op'>=</span><span class='cn'>TRUE</span>, nearpd<span class='op'>=</span><span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>vi</th>
      <td><p>numeric vector to specify the sampling variances of the observed effect sizes or outcomes.</p></td>
    </tr>
    <tr>
      <th>cluster</th>
      <td><p>vector to specify the clustering variable (e.g., study).</p></td>
    </tr>
    <tr>
      <th>subgroup</th>
      <td><p>optional vector to specify different (independent) subgroups within clusters.</p></td>
    </tr>
    <tr>
      <th>obs</th>
      <td><p>optional vector to distinguish different observed effect sizes or outcomes corresponding to the same construct or response/dependent variable.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>optional vector to distinguish different types of constructs or response/dependent variables underlying the observed effect sizes or outcomes.</p></td>
    </tr>
    <tr>
      <th>time1</th>
      <td><p>optional numeric vector to specify the time points when the observed effect sizes or outcomes were obtained (in the first condition if the observed effect sizes or outcomes represent contrasts between two conditions).</p></td>
    </tr>
    <tr>
      <th>time2</th>
      <td><p>optional numeric vector to specify the time points when the observed effect sizes or outcomes were obtained in the second condition (only relevant when the observed effect sizes or outcomes represent contrasts between two conditions).</p></td>
    </tr>
    <tr>
      <th>grp1</th>
      <td><p>optional vector to specify the group of the first condition when the observed effect sizes or outcomes represent contrasts between two conditions.</p></td>
    </tr>
    <tr>
      <th>grp2</th>
      <td><p>optional vector to specify the group of the second condition when the observed effect sizes or outcomes represent contrasts between two conditions.</p></td>
    </tr>
    <tr>
      <th>w1</th>
      <td><p>optional numeric vector to specify the size of the group (or more generally, the inverse-sampling variance weight) of the first condition when the observed effect sizes or outcomes represent contrasts between two conditions.</p></td>
    </tr>
    <tr>
      <th>w2</th>
      <td><p>optional numeric vector to specify the size of the group (or more generally, the inverse-sampling variance weight) of the second condition when the observed effect sizes or outcomes represent contrasts between two conditions.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>optional data frame containing the variables given to the arguments above.</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>argument to specify the correlation(s) of observed effect sizes or outcomes measured concurrently. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>phi</th>
      <td><p>argument to specify the autocorrelation of observed effect sizes or outcomes measured at different time points. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>rvars</th>
      <td><p>unused argument for the moment.</p></td>
    </tr>
    <tr>
      <th>checkpd</th>
      <td><p>logical to specify whether to check that the variance-covariance matrices within clusters are positive definite (the default is <code>TRUE</code>). See &#8216;Note&#8217;.</p></td>
    </tr>
    <tr>
      <th>nearpd</th>
      <td><p>logical to specify whether the <code><a href='https://rdrr.io/pkg/Matrix/man/nearPD.html'>nearPD</a></code> function from the <a href='https://cran.r-project.org/package=Matrix'>Matrix</a> package should be used on variance-covariance matrices that are not positive definite. See &#8216;Note&#8217;.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Standard meta-analytic models (such as those that can be fitted with the <code><a href='rma.uni.html'>rma.uni</a></code> function) assume that the observed effect sizes or outcomes (or more precisely, their sampling errors) are independent. This assumption is typically violated whenever multiple observed effect sizes or outcomes are computed based on the same sample of subjects (or whatever the unit of analysis is) or if there is at least partial overlap of subjects that contribute information to the computation of multiple effect sizes or outcomes.</p>
<p>The present function can be used to construct or approximate the variance-covariance matrix of the sampling errors of dependent effect sizes or outcomes for a wide variety of circumstances (this variance-covariance matrix is the so-called <code>V</code> matrix that may be needed as input for multilevel/multivariate meta-analytic models as can be fitted with the <code><a href='rma.mv.html'>rma.mv</a></code> function).</p>
<p>Argument <code>cluster</code> is used to specify the clustering variable. Rows with the same value of this variable are allowed to be dependent, while rows with different values are assumed to be independent. Typically, <code>cluster</code> will be a study identifier.</p>
<p>Within the same cluster, there may be different subgroups with no overlap of subjects across subgroups. Argument <code>subgroup</code> can be used to distinguish such subgroups. Rows with the same value of this variable within a cluster are allowed to be dependent, while rows with different values are assumed to be independent even if they come from the same cluster.</p>
<p>Multiple effect sizes or outcomes belonging to the same cluster and subgroup may be dependent due to a variety of reasons:</p><ol>
<li><p>The same construct of interest (e.g., severity of depression) may have been measured using different scales or instruments within a study (e.g., using the Beck Depression Inventory (BDI) and the Hamilton Depression Rating Scale (HDRS)) based on which multiple effect sizes can be computed in the same group of subjects (e.g., contrasting a treated versus a control group with respect to each scale). In this case, we have multiple effect sizes that are different &#8216;observations&#8217; of the effect with respect to the same type of construct.</p>
<p>Argument <code>obs</code> is then used to distinguish different effect sizes corresponding to the same construct. If <code>obs</code> is specified, then argument <code>rho</code> must also be specified to indicate the degree of correlation among the sampling errors of the different effect sizes. Since this correlation is typically not known, the correlation among the various scales (or a rough &#8216;guestimate&#8217; thereof) can be used as a proxy (i.e., the (typical) correlation between BDI and HDRS measurements).</p>
<p>One can also specify an entire correlation matrix via <code>rho</code> to indicate, for each possible pair of <code>obs</code> values, the corresponding correlation. The row/column names of the matrix must then correspond to the unique values of the <code>obs</code> variable.</p></li>
<li><p>Multiple types of constructs (or more generally, types of response/dependent variables) may have been measured in the same group of subjects (e.g., severity of depression as measured with the Beck Depression Inventory (BDI) and severity of anxiety as measured with the State-Trait Anxiety Inventory (STAI)). If this is of interest for a meta-analysis, effect sizes can then be computed with respect to each &#8216;type&#8217; of construct.</p>
<p>Argument <code>type</code> is then used to distinguish effect sizes corresponding to these different types of constructs. If <code>type</code> is specified, then argument <code>rho</code> must also be specified to indicate the degree of correlation among the sampling errors of effect sizes belonging to these different types. As above, the correlation among the various scales is typically used here as a proxy (i.e., the (typical) correlation between BDI and STAI measurements).</p>
<p>One can also specify an entire correlation matrix via <code>rho</code> to indicate, for each possible pair of <code>type</code> values, the corresponding correlation. The row/column names of the matrix must then correspond to the unique values of the <code>type</code> variable.</p></li>
<li><p>If there are multiple constructs, multiple scales or instruments may also have been used (in at least some of the studies) to measure the same construct and hence there may again be multiple effect sizes that are &#8216;observations&#8217; of the same type of construct. Arguments <code>type</code> and <code>obs</code> should then be used together to indicate the various construct types and observations thereof. In this case, argument <code>rho</code> must be a vector of two values, the first to specify the within-construct correlation and the second to specify the between-construct correlation.</p>
<p>One can also specify a list with two elements for <code>rho</code>, the first element being either a scalar or an entire correlation matrix for the within-construct correlation(s) and the second element being a scalar or an entire correlation matrix for the between-construct correlation(s). As above, any matrices specified must have row/column names corresponding to the unique values of the <code>obs</code> and/or <code>type</code> variables.</p></li>
<li><p>The same construct and scale may have been assessed/used multiple times, allowing the computation of multiple effect sizes for the same group of subjects at different time points (e.g., right after the end of a treatment, at a short-term follow-up, and at a long-term follow-up). Argument <code>time1</code> is then used to specify the time points when the observed effect sizes were obtained. Argument <code>phi</code> must then also be specified to indicate the autocorrelation among the sampling errors of two effect sizes that differ by one unit on the <code>time1</code> variable. As above, the autocorrelation of the measurements themselves can be used here as a proxy.</p>
<p>If multiple constructs and/or multiple scales have also been assessed at the various time points, then arguments <code>type</code> and/or <code>obs</code> (together with argument <code>rho</code>) should be used as needed to differentiate effect sizes corresponding to the different constructs and/or scales.</p></li>
<li><p>Many effect size or outcome measures (e.g., raw or standardized mean differences, log-transformed ratios of means, log risk/odds ratios and risk differences) reflect the difference between two conditions (i.e., a contrast). Within a study, there may be more than two conditions, allowing the computation of multiple such contrasts (e.g., treatment A versus a control condition and treatment B versus the same control condition) and hence corresponding effect sizes. The reuse of information from the &#8216;shared&#8217; condition (in this example, the control condition) then induces correlation among the effect sizes.</p>
<p>To account for this, arguments <code>grp1</code> and <code>grp2</code> should be specified to indicate (within a cluster or subgroup thereof) which two groups were compared in the computation of each effect size (e.g., in the example above, the coding could be <code>grp1=c(1,2)</code> and <code>grp2=c(3,3)</code>; whether numbers or strings are used as identifiers is irrelevant).</p>
<p>The degree of correlation between two contrast-type effect sizes that is induced by the use of a shared condition is a function of the size of the groups involved in the computation of the two effect sizes (or, more generally, the inverse-sampling variance weights of the condition-specific outcomes). By default, the group sizes (weights) are assumed to be identical across conditions, which implies a correlation of 0.5. If the group sizes (weights) are known, they can be specified via arguments <code>w1</code> and <code>w2</code>.</p>
<p>In fact, a contrast-type effect size can be based on a between- or a within-subjects design. When at least one or more of the contrast-type effect sizes are based on a within-subjects design, then <code>time1</code> and <code>time2</code> should be used in combination with <code>grp1</code> and <code>grp2</code> to indicate for each effect size the group(s) and time point(s) involved.</p>
<p>For example, <code>grp1=c(1,2)</code> and <code>grp2=c(3,3)</code> as above in combination with <code>time1=c(1,1)</code> and <code>time2=c(1,1)</code> would imply a between-subjects design involving three groups where two effect size were computed contrasting groups 1 and 2 versus group 3 at a single time point. On the other hand, <code>grp1=c(1,1)</code> and <code>grp2=c(1,1)</code> in combination with <code>time1=c(2,1)</code> and <code>time2=c(3,1)</code> would imply a within-subjects design where two effect size were computed contrasting time points 2 and 3 versus time point 1 in a single group. Argument <code>phi</code> is then used as above to indicate the autocorrelation of the measurements within groups (i.e., for the within-subjects design above, it would be the autocorrelation between time points 2 and 1 or equivalently, between time points 3 and 2).</p></li>
</ol>


    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A \(k \times k\) variance-covariance matrix, where \(k\) denotes the length of the <code>vi</code> variable (i.e., the number of rows in the dataset).</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Depending on the data structure, the specified variables, and the specified values for <code>rho</code> and/or <code>phi</code>, it is possible that the constructed variance-covariance matrix is not positive definite within one or more clusters (this is checked when <code>checkpd=TRUE</code>, which is the default). If such non-positive definite submatrices are found, the reasons for this should be carefully checked since this might indicate misapplication of the function and/or the specification of implausible values for <code>rho</code> and/or <code>phi</code>.</p>
<p>When setting <code>nearpd=TRUE</code>, the <code><a href='https://rdrr.io/pkg/Matrix/man/nearPD.html'>nearPD</a></code> function from the <a href='https://cran.r-project.org/package=Matrix'>Matrix</a> package is used on variance-covariance submatrices that are not positive definite. This should only be used cautiously and after understanding why these matrices are not positive definite.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Wolfgang Viechtbauer <a href='mailto:wvb@metafor-project.org'>wvb@metafor-project.org</a> <a href='https://www.metafor-project.org'>https://www.metafor-project.org</a></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1--48. <a href='https://doi.org/10.18637/jss.v036.i03'>https://doi.org/10.18637/jss.v036.i03</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='escalc.html'>escalc</a></code>, <code><a href='rcalc.html'>rcalc</a></code>, <code><a href='rma.mv.html'>rma.mv</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>############################################################################</span>

<span class='co'># see help(dat.assink2016) for further details on this dataset</span>

<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.assink2016</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;     study esid  id      yi     vi pubstatus  year deltype
#&gt; 1       1    1   1  0.9066 0.0740         1   4.5 general
#&gt; 2       1    2   2  0.4295 0.0398         1   4.5 general
#&gt; 3       1    3   3  0.2679 0.0481         1   4.5 general
#&gt; 4       1    4   4  0.2078 0.0239         1   4.5 general
#&gt; 5       1    5   5  0.0526 0.0331         1   4.5 general
#&gt; 6       1    6   6 -0.0507 0.0886         1   4.5 general
#&gt; 7       2    1   7  0.5117 0.0115         1   1.5 general
#&gt; 8       2    2   8  0.4738 0.0076         1   1.5 general
#&gt; 9       2    3   9  0.3544 0.0065         1   1.5 general
#&gt; 10      3    1  10  2.2844 0.3325         1  -8.5 general
#&gt; 11      3    2  11  2.1771 0.3073         1  -8.5 general
#&gt; 12      3    3  12  1.7777 0.2697         1  -8.5 general
#&gt; 13      3    4  13  1.5480 0.4533         1  -8.5 general
#&gt; 14      3    5  14  1.4855 0.1167         1  -6.5 general
#&gt; 15      3    6  15  1.4836 0.1706         1  -6.5 general
#&gt; 16      3    7  16  1.2777 0.1538         1  -8.5 general
#&gt; 17      3    8  17  1.0311 0.3132         1  -8.5 general
#&gt; 18      3    9  18  0.9409 0.1487         1  -6.5 general
#&gt; 19      3   10  19  0.6263 0.2139         1  -6.5 general
#&gt; 20      4    1  20 -0.0447 0.0331         1  -7.5 general
#&gt; 21      5    1  21  1.5490 0.1384         1 -11.5 general
#&gt; 22      6    1  22  0.7516 0.0477         1   5.5 general
#&gt; 23      6    2  23  0.3979 0.0449         1   5.5 general
#&gt; 24      6    3  24  0.2062 0.3533         1   5.5 general
#&gt; 25      6    4  25 -0.2927 0.0758         1   5.5 general
#&gt; 26      6    5  26 -0.5067 0.0314         1   5.5 general
#&gt; 27      7    1  27  1.7083 0.0729         1   3.5 general
#&gt; 28      7    2  28  0.8003 0.0815         1   3.5 general
#&gt; 29      7    3  29  0.7268 0.1394         1   3.5 general
#&gt; 30      7    4  30  0.6569 0.0943         1   3.5 general
#&gt; 31      7    5  31  0.5569 0.1355         1   3.5 general
#&gt; 32      7    6  32  0.3504 0.0763         1   3.5 general
#&gt; 33      8    1  33  0.3695 0.0199         1   1.5 general
#&gt; 34      9    1  34  0.1048 0.0331         1   5.5 general
#&gt; 35      9    2  35  0.1748 0.0346         1   5.5 general
#&gt; 36     10    1  36  0.4549 0.0278         1   4.5 general
#&gt; 37     10    2  37  0.3161 0.0185         1   4.5 general
#&gt; 38     10    3  38  0.0826 0.0328         1   4.5 general
#&gt; 39     10    4  39  0.0221 0.0612         1   4.5 general
#&gt; 40     10    5  40 -0.0199 0.0127         1   4.5 general
#&gt; 41     11    1  41  2.3580 0.1226         0  -6.5 general
#&gt; 42     11    2  42  2.3580 0.1226         0  -6.5 general
#&gt; 43     11    3  43  2.3157 0.2416         0  -6.5 general
#&gt; 44     11    4  44  2.0765 0.0844         0  -6.5 general
#&gt; 45     11    5  45  2.0034 0.0780         0  -6.5 general
#&gt; 46     11    6  46  1.7716 0.0723         0  -6.5 general
#&gt; 47     11    7  47  1.4918 0.0701         0  -6.5 general
#&gt; 48     11    8  48  1.4476 0.0422         0  -6.5 general
#&gt; 49     11    9  49  1.2897 0.0663         0  -6.5   overt
#&gt; 50     11   10  50  1.2637 0.0935         0  -6.5   overt
#&gt; 51     11   11  51  1.2423 0.0392         0  -6.5 general
#&gt; 52     11   12  52  1.1769 0.0387         0  -6.5 general
#&gt; 53     11   13  53  1.0760 0.0391         0  -6.5 general
#&gt; 54     11   14  54  1.0653 0.0380         0  -6.5   overt
#&gt; 55     11   15  55  1.0379 0.1651         0  -6.5 general
#&gt; 56     11   16  56  1.0101 0.0586         0  -6.5   overt
#&gt; 57     11   17  57  1.0087 0.0386         0  -6.5   overt
#&gt; 58     11   18  58  0.8765 0.0893         0  -6.5 general
#&gt; 59     11   19  59  0.8615 0.1591         0  -6.5   overt
#&gt; 60     11   20  60  0.8531 0.0350         0  -6.5 general
#&gt; 61     11   21  61  0.6999 0.0353         0  -6.5 general
#&gt; 62     11   22  62  0.6947 0.0353         0  -6.5 general
#&gt; 63     12    1  63  0.2994 0.0041         0   4.5   overt
#&gt; 64     12    2  64  0.2992 0.0042         0   4.5 general
#&gt; 65     12    3  65  0.2989 0.0041         0   4.5   overt
#&gt; 66     12    4  66  0.2910 0.0042         0   4.5   overt
#&gt; 67     12    5  67  0.2170 0.0041         0   4.5   overt
#&gt; 68     13    1  68  0.3874 0.0138         1  -3.5 general
#&gt; 69     13    2  69  0.2178 0.0137         1  -3.5 general
#&gt; 70     14    1  70  0.4571 0.0100         1  -1.5 general
#&gt; 71     14    2  71  0.1947 0.0059         1  -1.5 general
#&gt; 72     14    3  72  0.0239 0.0025         1  -1.5 general
#&gt; 73     14    4  73 -0.0575 0.0032         1  -1.5 general
#&gt; 74     14    5  74 -0.1190 0.0789         1  -1.5 general
#&gt; 75     14    6  75 -0.2945 0.0179         1  -1.5 general
#&gt; 76     15    1  76  0.7130 0.1537         1 -13.5 general
#&gt; 77     15    2  77  0.3990 0.2334         1 -13.5 general
#&gt; 78     15    3  78 -0.7645 0.1674         1 -13.5 general
#&gt; 79     16    1  79  0.7156 0.0914         1   2.5   overt
#&gt; 80     16    2  80  0.7067 0.0875         1   2.5  covert
#&gt; 81     16    3  81  0.6475 0.0330         1   2.5 general
#&gt; 82     16    4  82  0.6428 0.0861         1   2.5  covert
#&gt; 83     16    5  83  0.6271 0.0400         1   2.5 general
#&gt; 84     16    6  84  0.6238 0.0680         1   2.5 general
#&gt; 85     16    7  85  0.6025 0.1287         1   2.5   overt
#&gt; 86     16    8  86  0.5763 0.0332         1   2.5 general
#&gt; 87     16    9  87  0.5171 0.0517         1   2.5  covert
#&gt; 88     16   10  88 -0.3797 0.0390         1   2.5  covert
#&gt; 89     16   11  89 -0.4228 0.0664         1   2.5  covert
#&gt; 90     16   12  90 -0.4245 0.0809         1   2.5  covert
#&gt; 91     16   13  91 -0.4671 0.0667         1   2.5  covert
#&gt; 92     16   14  92 -0.5230 0.0988         1   2.5   overt
#&gt; 93     16   15  93 -0.5675 0.0340         1   2.5  covert
#&gt; 94     16   16  94 -0.7586 0.0437         1   2.5  covert
#&gt; 95     17    1  95  0.3453 0.0340         1   5.5 general
#&gt; 96     17    2  96  0.1221 0.0158         1   5.5 general
#&gt; 97     17    3  97  0.0906 0.0107         1   5.5 general
#&gt; 98     17    4  98  0.0040 0.0208         1   5.5 general
#&gt; 99     17    5  99 -0.0207 0.0123         1   5.5 general
#&gt; 100    17    6 100 -0.0660 0.0100         1   5.5 general</div><div class='input'>
<span class='co'># assume that the effect sizes within studies are correlated with rho=0.6</span>
<span class='va'>V</span> <span class='op'>&lt;-</span> <span class='fu'>vcalc</span><span class='op'>(</span><span class='va'>vi</span>, cluster<span class='op'>=</span><span class='va'>study</span>, obs<span class='op'>=</span><span class='va'>esid</span>, data<span class='op'>=</span><span class='va'>dat</span>, rho<span class='op'>=</span><span class='fl'>0.6</span><span class='op'>)</span>
<span class='va'>V</span><span class='op'>[</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>
</div><div class='output co'>#&gt;             [,1]       [,2]       [,3]       [,4]       [,5]       [,6]
#&gt;  [1,] 0.07400000 0.03256182 0.03579642 0.02523284 0.02969485 0.04858296
#&gt;  [2,] 0.03256182 0.03980000 0.02625218 0.01850511 0.02177744 0.03562949
#&gt;  [3,] 0.03579642 0.02625218 0.04810000 0.02034336 0.02394075 0.03916883
#&gt;  [4,] 0.02523284 0.01850511 0.02034336 0.02390000 0.01687579 0.02761004
#&gt;  [5,] 0.02969485 0.02177744 0.02394075 0.01687579 0.03310000 0.03249242
#&gt;  [6,] 0.04858296 0.03562949 0.03916883 0.02761004 0.03249242 0.08860000
#&gt;  [7,] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [8,] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [9,] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;              [,7]        [,8]        [,9]
#&gt;  [1,] 0.000000000 0.000000000 0.000000000
#&gt;  [2,] 0.000000000 0.000000000 0.000000000
#&gt;  [3,] 0.000000000 0.000000000 0.000000000
#&gt;  [4,] 0.000000000 0.000000000 0.000000000
#&gt;  [5,] 0.000000000 0.000000000 0.000000000
#&gt;  [6,] 0.000000000 0.000000000 0.000000000
#&gt;  [7,] 0.011500000 0.005609278 0.005187485
#&gt;  [8,] 0.005609278 0.007600000 0.004217108
#&gt;  [9,] 0.005187485 0.004217108 0.006500000</div><div class='input'>
<span class='co'># use a correlation of 0.7 for effect sizes corresponding to the same type of</span>
<span class='co'># delinquent behavior and a correlation of 0.5 for effect sizes corresponding</span>
<span class='co'># to different types of delinquent behavior</span>
<span class='va'>V</span> <span class='op'>&lt;-</span> <span class='fu'>vcalc</span><span class='op'>(</span><span class='va'>vi</span>, cluster<span class='op'>=</span><span class='va'>study</span>, type<span class='op'>=</span><span class='va'>deltype</span>, obs<span class='op'>=</span><span class='va'>esid</span>, data<span class='op'>=</span><span class='va'>dat</span>, rho<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.7</span>, <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>V</span><span class='op'>[</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span> <span class='op'>%in%</span> <span class='fl'>16</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span> <span class='op'>%in%</span> <span class='fl'>16</span><span class='op'>]</span>
</div><div class='output co'>#&gt;             [,1]       [,2]       [,3]       [,4]       [,5]       [,6]
#&gt;  [1,] 0.09140000 0.04471437 0.02745997 0.04435521 0.03023243 0.03941827
#&gt;  [2,] 0.04471437 0.08750000 0.02686773 0.06075802 0.02958040 0.03856812
#&gt;  [3,] 0.02745997 0.02686773 0.03300000 0.02665192 0.02543226 0.03315961
#&gt;  [4,] 0.04435521 0.06075802 0.02665192 0.08610000 0.02934280 0.03825833
#&gt;  [5,] 0.03023243 0.02958040 0.02543226 0.02934280 0.04000000 0.03650753
#&gt;  [6,] 0.03941827 0.03856812 0.03315961 0.03825833 0.03650753 0.06800000
#&gt;  [7,] 0.07592074 0.05305952 0.03258489 0.05263333 0.03587478 0.04677499
#&gt;  [8,] 0.02754306 0.02694903 0.02316989 0.02673256 0.02550921 0.03325995
#&gt;  [9,] 0.03437070 0.04708118 0.02065248 0.04670301 0.02273763 0.02964625
#&gt; [10,] 0.02985214 0.04089163 0.01793739 0.04056317 0.01974842 0.02574879
#&gt; [11,] 0.03895177 0.05335635 0.02340513 0.05292778 0.02576820 0.03359762
#&gt; [12,] 0.04299494 0.05889472 0.02583457 0.05842166 0.02844293 0.03708504
#&gt; [13,] 0.03903966 0.05347675 0.02345794 0.05304721 0.02582634 0.03367343
#&gt; [14,] 0.06651960 0.04648925 0.02854996 0.04611583 0.03143247 0.04098292
#&gt; [15,] 0.02787293 0.03818049 0.01674813 0.03787382 0.01843909 0.02404163
#&gt; [16,] 0.03159976 0.04328553 0.01898750 0.04293785 0.02090454 0.02725619
#&gt;             [,7]       [,8]       [,9]      [,10]      [,11]      [,12]
#&gt;  [1,] 0.07592074 0.02754306 0.03437070 0.02985214 0.03895177 0.04299494
#&gt;  [2,] 0.05305952 0.02694903 0.04708118 0.04089163 0.05335635 0.05889472
#&gt;  [3,] 0.03258489 0.02316989 0.02065248 0.01793739 0.02340513 0.02583457
#&gt;  [4,] 0.05263333 0.02673256 0.04670301 0.04056317 0.05292778 0.05842166
#&gt;  [5,] 0.03587478 0.02550921 0.02273763 0.01974842 0.02576820 0.02844293
#&gt;  [6,] 0.04677499 0.03325995 0.02964625 0.02574879 0.03359762 0.03708504
#&gt;  [7,] 0.12870000 0.03268348 0.04078538 0.03542351 0.04622142 0.05101919
#&gt;  [8,] 0.03268348 0.03320000 0.02071497 0.01799166 0.02347595 0.02591274
#&gt;  [9,] 0.04078538 0.02071497 0.05170000 0.03143226 0.04101355 0.04527074
#&gt; [10,] 0.03542351 0.01799166 0.03143226 0.03900000 0.03562168 0.03931919
#&gt; [11,] 0.04622142 0.02347595 0.04101355 0.03562168 0.06640000 0.05130460
#&gt; [12,] 0.05101919 0.02591274 0.04527074 0.03931919 0.05130460 0.08090000
#&gt; [13,] 0.04632572 0.02352892 0.04110610 0.03570206 0.04658488 0.05142037
#&gt; [14,] 0.07893430 0.02863634 0.03573500 0.03103707 0.04049790 0.04470157
#&gt; [15,] 0.03307491 0.01679881 0.02934829 0.02549000 0.03325995 0.03671231
#&gt; [16,] 0.03749730 0.01904495 0.03327239 0.02889822 0.03770707 0.04162105
#&gt;            [,13]      [,14]      [,15]      [,16]
#&gt;  [1,] 0.03903966 0.06651960 0.02787293 0.03159976
#&gt;  [2,] 0.05347675 0.04648925 0.03818049 0.04328553
#&gt;  [3,] 0.02345794 0.02854996 0.01674813 0.01898750
#&gt;  [4,] 0.05304721 0.04611583 0.03787382 0.04293785
#&gt;  [5,] 0.02582634 0.03143247 0.01843909 0.02090454
#&gt;  [6,] 0.03367343 0.04098292 0.02404163 0.02725619
#&gt;  [7,] 0.04632572 0.07893430 0.03307491 0.03749730
#&gt;  [8,] 0.02352892 0.02863634 0.01679881 0.01904495
#&gt;  [9,] 0.04110610 0.03573500 0.02934829 0.03327239
#&gt; [10,] 0.03570206 0.03103707 0.02549000 0.02889822
#&gt; [11,] 0.04658488 0.04049790 0.03325995 0.03770707
#&gt; [12,] 0.05142037 0.04470157 0.03671231 0.04162105
#&gt; [13,] 0.06670000 0.04058928 0.03333500 0.03779216
#&gt; [14,] 0.04058928 0.09880000 0.02897930 0.03285407
#&gt; [15,] 0.03333500 0.02897930 0.03400000 0.02698225
#&gt; [16,] 0.03779216 0.03285407 0.02698225 0.04370000</div><div class='input'><span class='co'># examine the correlation matrix for study 16</span>
<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov2cor</a></span><span class='op'>(</span><span class='va'>V</span><span class='op'>[</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span> <span class='op'>%in%</span> <span class='fl'>16</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span> <span class='op'>%in%</span> <span class='fl'>16</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
#&gt;  [1,]  1.0  0.5  0.5  0.5  0.5  0.5  0.7  0.5  0.5   0.5   0.5   0.5   0.5
#&gt;  [2,]  0.5  1.0  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   0.7
#&gt;  [3,]  0.5  0.5  1.0  0.5  0.7  0.7  0.5  0.7  0.5   0.5   0.5   0.5   0.5
#&gt;  [4,]  0.5  0.7  0.5  1.0  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   0.7
#&gt;  [5,]  0.5  0.5  0.7  0.5  1.0  0.7  0.5  0.7  0.5   0.5   0.5   0.5   0.5
#&gt;  [6,]  0.5  0.5  0.7  0.5  0.7  1.0  0.5  0.7  0.5   0.5   0.5   0.5   0.5
#&gt;  [7,]  0.7  0.5  0.5  0.5  0.5  0.5  1.0  0.5  0.5   0.5   0.5   0.5   0.5
#&gt;  [8,]  0.5  0.5  0.7  0.5  0.7  0.7  0.5  1.0  0.5   0.5   0.5   0.5   0.5
#&gt;  [9,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  1.0   0.7   0.7   0.7   0.7
#&gt; [10,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   1.0   0.7   0.7   0.7
#&gt; [11,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   1.0   0.7   0.7
#&gt; [12,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   1.0   0.7
#&gt; [13,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   1.0
#&gt; [14,]  0.7  0.5  0.5  0.5  0.5  0.5  0.7  0.5  0.5   0.5   0.5   0.5   0.5
#&gt; [15,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   0.7
#&gt; [16,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   0.7
#&gt;       [,14] [,15] [,16]
#&gt;  [1,]   0.7   0.5   0.5
#&gt;  [2,]   0.5   0.7   0.7
#&gt;  [3,]   0.5   0.5   0.5
#&gt;  [4,]   0.5   0.7   0.7
#&gt;  [5,]   0.5   0.5   0.5
#&gt;  [6,]   0.5   0.5   0.5
#&gt;  [7,]   0.7   0.5   0.5
#&gt;  [8,]   0.5   0.5   0.5
#&gt;  [9,]   0.5   0.7   0.7
#&gt; [10,]   0.5   0.7   0.7
#&gt; [11,]   0.5   0.7   0.7
#&gt; [12,]   0.5   0.7   0.7
#&gt; [13,]   0.5   0.7   0.7
#&gt; [14,]   1.0   0.5   0.5
#&gt; [15,]   0.5   1.0   0.7
#&gt; [16,]   0.5   0.7   1.0</div><div class='input'>
<span class='co'>############################################################################</span>

<span class='co'># see help(dat.kalaian1996) for further details on this dataset</span>

<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.kalaian1996</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;    id                   study year n1i n2i outcome    yi     vi  hrs ets
#&gt; 1   1   Alderman &amp; Powers (A) 1980  28  22  verbal  0.22 0.0817  7.0   1
#&gt; 2   2   Alderman &amp; Powers (B) 1980  39  40  verbal  0.09 0.0507 10.0   1
#&gt; 3   3   Alderman &amp; Powers (C) 1980  22  17  verbal  0.14 0.1045 10.5   1
#&gt; 4   4   Alderman &amp; Powers (D) 1980  48  43  verbal  0.14 0.0442 10.0   1
#&gt; 5   5   Alderman &amp; Powers (E) 1980  25  74  verbal -0.01 0.0535  6.0   1
#&gt; 6   6   Alderman &amp; Powers (F) 1980  37  35  verbal  0.14 0.0557  5.0   1
#&gt; 7   7   Alderman &amp; Powers (G) 1980  24  70  verbal  0.18 0.0561 11.0   1
#&gt; 8   8   Alderman &amp; Powers (H) 1980  16  19  verbal  0.01 0.1151 45.0   1
#&gt; 9   9        Evans &amp; Pike (A) 1973 145 129  verbal  0.13 0.0147 21.0   1
#&gt; 10 10        Evans &amp; Pike (A) 1973 145 129    math  0.12 0.0147 21.0   1
#&gt; 11 11        Evans &amp; Pike (B) 1973  72 129  verbal  0.25 0.0218 21.0   1
#&gt; 12 12        Evans &amp; Pike (B) 1973  72 129    math  0.06 0.0216 21.0   1
#&gt; 13 13        Evans &amp; Pike (C) 1973  71 129  verbal  0.31 0.0221 21.0   1
#&gt; 14 14        Evans &amp; Pike (C) 1973  71 129    math  0.09 0.0219 21.0   1
#&gt; 15 15               Laschewer 1986  13  14  verbal  0.00 0.1484  8.9   0
#&gt; 16 16               Laschewer 1986  13  14    math  0.07 0.1484  8.9   0
#&gt; 17 17 Roberts &amp; Oppenheim (A) 1966  43  37  verbal  0.01 0.0503  7.5   1
#&gt; 18 18 Roberts &amp; Oppenheim (B) 1966  19  13  verbal  0.67 0.1366  7.5   1
#&gt; 19 19 Roberts &amp; Oppenheim (D) 1966  16  11  verbal -0.38 0.1561  7.5   1
#&gt; 20 20 Roberts &amp; Oppenheim (E) 1966  20  12  verbal -0.24 0.1342  7.5   1
#&gt; 21 21 Roberts &amp; Oppenheim (F) 1966  39  28  verbal  0.29 0.0620  7.5   1
#&gt; 22 22 Roberts &amp; Oppenheim (G) 1966  38  25    math  0.26 0.0669  7.5   1
#&gt; 23 23 Roberts &amp; Oppenheim (H) 1966  18  13    math -0.41 0.1352  7.5   1
#&gt; 24 24 Roberts &amp; Oppenheim (I) 1966  19  13    math  0.08 0.1297  7.5   1
#&gt; 25 25 Roberts &amp; Oppenheim (J) 1966  37  22    math  0.30 0.0732  7.5   1
#&gt; 26 26 Roberts &amp; Oppenheim (K) 1966  19  11    math -0.53 0.1482  7.5   1
#&gt; 27 27 Roberts &amp; Oppenheim (L) 1966  17  13    math  0.13 0.1360  7.5   1
#&gt; 28 28 Roberts &amp; Oppenheim (M) 1966  20  12    math  0.26 0.1344  7.5   1
#&gt; 29 29 Roberts &amp; Oppenheim (N) 1966  20  13    math  0.47 0.1303  7.5   1
#&gt; 30 30               Zuman (B) 1988  16  17  verbal  0.13 0.1216 24.0   0
#&gt; 31 31               Zuman (B) 1988  16  17    math  0.48 0.1248 24.0   0
#&gt; 32 32               Burke (A) 1986  25  25  verbal  0.50 0.0825 50.0   0
#&gt; 33 33               Burke (B) 1986  25  25  verbal  0.74 0.0855 50.0   0
#&gt; 34 34                  Coffin 1987   8   8  verbal -0.23 0.2517 18.0   0
#&gt; 35 35                  Coffin 1987   8   8    math  0.33 0.2534 18.0   0
#&gt; 36 36                   Davis 1985  22  21  verbal  0.13 0.0933 15.0   0
#&gt; 37 37                   Davis 1985  22  21    math  0.13 0.0933 15.0   0
#&gt; 38 38                 Frankel 1960  45  45  verbal  0.13 0.0445 30.0   0
#&gt; 39 39                 Frankel 1960  45  45    math  0.34 0.0451 30.0   0
#&gt; 40 40                Kintisch 1979  38  38  verbal  0.06 0.0527 20.0   0
#&gt; 41 41                  Whitla 1962  52  52  verbal  0.09 0.0385 10.0   1
#&gt; 42 42                  Whitla 1962  52  52    math -0.11 0.0385 10.0   1
#&gt; 43 43              Curran (A) 1988  21  17  verbal -0.10 0.1066  6.0   0
#&gt; 44 44              Curran (A) 1988  21  17    math -0.08 0.1065  6.0   0
#&gt; 45 45              Curran (B) 1988  24  17  verbal -0.14 0.1007  6.0   0
#&gt; 46 46              Curran (B) 1988  24  17    math -0.29 0.1015  6.0   0
#&gt; 47 47              Curran (C) 1988  20  17  verbal -0.16 0.1092  6.0   0
#&gt; 48 48              Curran (C) 1988  20  17    math -0.34 0.1104  6.0   0
#&gt; 49 49              Curran (D) 1988  20  17  verbal -0.07 0.1089  6.0   0
#&gt; 50 50              Curran (D) 1988  20  17    math -0.06 0.1089  6.0   0
#&gt; 51 51                    Dear 1958  60 526  verbal -0.02 0.0186 15.0   1
#&gt; 52 52                    Dear 1958  60 526    math  0.21 0.0186 15.0   1
#&gt; 53 53                    Dyer 1953 225 193  verbal  0.06 0.0096 15.0   1
#&gt; 54 54                    Dyer 1953 225 193    math  0.17 0.0097 15.0   1
#&gt; 55 55              French (B) 1955 110 158  verbal  0.06 0.0154  4.5   1
#&gt; 56 56              French (C) 1955 161 158    math  0.20 0.0126 15.0   1
#&gt; 57 57                     FTC 1978 192 684  verbal  0.15 0.0067 40.0   0
#&gt; 58 58                     FTC 1978 192 684    math  0.03 0.0067 40.0   0
#&gt; 59 59               Keefauver 1976  16  25  verbal  0.17 0.1029 14.0   0
#&gt; 60 60               Keefauver 1976  16  25    math -0.19 0.1029 14.0   0
#&gt; 61 61                    Lass 1961  38  82  verbal  0.02 0.0385   NA   1
#&gt; 62 62                    Lass 1961  38  82    math  0.10 0.0386   NA   1
#&gt; 63 63      Reynolds &amp; Oberman 1987  93  47  verbal -0.04 0.0320 63.0   0
#&gt; 64 64      Reynolds &amp; Oberman 1987  93  47    math  0.60 0.0333 63.0   0
#&gt; 65 65                  Teague 1992  10  15  verbal  0.40 0.1699 18.0   0
#&gt; 66 66               Zuman (A) 1988  21  34  verbal  0.54 0.0797 27.0   0
#&gt; 67 67               Zuman (A) 1988  21  34    math  0.57 0.0800 27.0   0
#&gt;    homework type
#&gt; 1         1    1
#&gt; 2         1    1
#&gt; 3         1    1
#&gt; 4         1    1
#&gt; 5         1    1
#&gt; 6         1    1
#&gt; 7         1    1
#&gt; 8         1    1
#&gt; 9         1    1
#&gt; 10        1    1
#&gt; 11        1    1
#&gt; 12        1    1
#&gt; 13        1    1
#&gt; 14        1    1
#&gt; 15        0    1
#&gt; 16        0    1
#&gt; 17        0    1
#&gt; 18        0    1
#&gt; 19        0    1
#&gt; 20        0    1
#&gt; 21        0    1
#&gt; 22        0    1
#&gt; 23        0    1
#&gt; 24        0    1
#&gt; 25        0    1
#&gt; 26        0    1
#&gt; 27        0    1
#&gt; 28        0    1
#&gt; 29        0    1
#&gt; 30        1    1
#&gt; 31        1    1
#&gt; 32        1    2
#&gt; 33        1    2
#&gt; 34        0    2
#&gt; 35        0    2
#&gt; 36        0    2
#&gt; 37        0    2
#&gt; 38        0    2
#&gt; 39        0    2
#&gt; 40        1    2
#&gt; 41        1    2
#&gt; 42        1    2
#&gt; 43        0    3
#&gt; 44        0    3
#&gt; 45        0    3
#&gt; 46        0    3
#&gt; 47        0    3
#&gt; 48        0    3
#&gt; 49        0    3
#&gt; 50        0    3
#&gt; 51        1    3
#&gt; 52        1    3
#&gt; 53        1    3
#&gt; 54        1    3
#&gt; 55        1    3
#&gt; 56        1    3
#&gt; 57        0    3
#&gt; 58        0    3
#&gt; 59        0    3
#&gt; 60        0    3
#&gt; 61        1    3
#&gt; 62        1    3
#&gt; 63        l    3
#&gt; 64        l    3
#&gt; 65        0    3
#&gt; 66        1    3
#&gt; 67        1    3</div><div class='input'>
<span class='co'># construct the variance-covariance matrix assuming rho = 0.66 for effect sizes</span>
<span class='co'># corresponding to the 'verbal' and 'math' outcome types</span>
<span class='va'>V</span> <span class='op'>&lt;-</span> <span class='fu'>vcalc</span><span class='op'>(</span><span class='va'>vi</span>, cluster<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span>, type<span class='op'>=</span><span class='va'>outcome</span>, data<span class='op'>=</span><span class='va'>dat</span>, rho<span class='op'>=</span><span class='fl'>0.66</span><span class='op'>)</span>
<span class='va'>V</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>14</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>14</span><span class='op'>]</span>
</div><div class='output co'>#&gt;         [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]     [,9]    [,10]
#&gt;  [1,] 0.0817 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.000000 0.000000
#&gt;  [2,] 0.0000 0.0507 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.000000 0.000000
#&gt;  [3,] 0.0000 0.0000 0.1045 0.0000 0.0000 0.0000 0.0000 0.0000 0.000000 0.000000
#&gt;  [4,] 0.0000 0.0000 0.0000 0.0442 0.0000 0.0000 0.0000 0.0000 0.000000 0.000000
#&gt;  [5,] 0.0000 0.0000 0.0000 0.0000 0.0535 0.0000 0.0000 0.0000 0.000000 0.000000
#&gt;  [6,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0557 0.0000 0.0000 0.000000 0.000000
#&gt;  [7,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0561 0.0000 0.000000 0.000000
#&gt;  [8,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.1151 0.000000 0.000000
#&gt;  [9,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.014700 0.009702
#&gt; [10,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.009702 0.014700
#&gt; [11,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.000000 0.000000
#&gt; [12,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.000000 0.000000
#&gt; [13,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.000000 0.000000
#&gt; [14,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.000000 0.000000
#&gt;            [,11]      [,12]      [,13]      [,14]
#&gt;  [1,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [2,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [3,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [4,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [5,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [6,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [7,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [8,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt;  [9,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt; [10,] 0.00000000 0.00000000 0.00000000 0.00000000
#&gt; [11,] 0.02180000 0.01432185 0.00000000 0.00000000
#&gt; [12,] 0.01432185 0.02160000 0.00000000 0.00000000
#&gt; [13,] 0.00000000 0.00000000 0.02210000 0.01451985
#&gt; [14,] 0.00000000 0.00000000 0.01451985 0.02190000</div><div class='input'>
<span class='co'>############################################################################</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p>Made with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1, using <a href="https://preferably.amirmasoudabdol.name/?source=footer">preferably</a> template.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


