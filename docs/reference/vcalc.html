<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light"><script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Construct or Approximate the Variance-Covariance Matrix of Dependent Effect Sizes or Outcomes — vcalc • metafor</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Construct or Approximate the Variance-Covariance Matrix of Dependent Effect Sizes or Outcomes — vcalc"><meta property="og:description" content="The function can be used to construct or approximate the variance-covariance matrix of dependent effect sizes or outcomes, or more precisely, of their sampling errors (i.e., the V matrix in rma.mv). "><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@wviechtb"><meta name="twitter:site" content="@wviechtb"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)"><!-- preferably CSS --><link rel="stylesheet" href="../preferably.css"><link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"><link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)"><script src="../darkswitch.js"></script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.5-10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/article/view/v036i03" class="external-link">JSS Article</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
          <a href="#" id="css-toggle-btn">
            <span class="fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        <li>
  <a href="https://twitter.com/wviechtb" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
        
        


      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct or Approximate the Variance-Covariance Matrix of Dependent Effect Sizes or Outcomes</h1>
    
    <div class="hidden name"><code>vcalc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function can be used to construct or approximate the variance-covariance matrix of dependent effect sizes or outcomes, or more precisely, of their sampling errors (i.e., the <code>V</code> matrix in <code><a href="rma.mv.html">rma.mv</a></code>). <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">vcalc</span><span class="op">(</span><span class="va">vi</span>, <span class="va">cluster</span>, <span class="va">subgroup</span>, <span class="va">obs</span>, <span class="va">type</span>, <span class="va">time1</span>, <span class="va">time2</span>, <span class="va">grp1</span>, <span class="va">grp2</span>, <span class="va">w1</span>, <span class="va">w2</span>,
      <span class="va">data</span>, <span class="va">rho</span>, <span class="va">phi</span>, <span class="va">rvars</span>, checkpd<span class="op">=</span><span class="cn">TRUE</span>, nearpd<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>vi</dt>
<dd><p>numeric vector to specify the sampling variances of the observed effect sizes or outcomes.</p></dd>

   <dt>cluster</dt>
<dd><p>vector to specify the clustering variable (e.g., study).</p></dd>

   <dt>subgroup</dt>
<dd><p>optional vector to specify different (independent) subgroups within clusters.</p></dd>

   <dt>obs</dt>
<dd><p>optional vector to distinguish different observed effect sizes or outcomes corresponding to the same construct or response/dependent variable.</p></dd>

   <dt>type</dt>
<dd><p>optional vector to distinguish different types of constructs or response/dependent variables underlying the observed effect sizes or outcomes.</p></dd>

   <dt>time1</dt>
<dd><p>optional numeric vector to specify the time points when the observed effect sizes or outcomes were obtained (in the first condition if the observed effect sizes or outcomes represent contrasts between two conditions).</p></dd>

   <dt>time2</dt>
<dd><p>optional numeric vector to specify the time points when the observed effect sizes or outcomes were obtained in the second condition (only relevant when the observed effect sizes or outcomes represent contrasts between two conditions).</p></dd>

   <dt>grp1</dt>
<dd><p>optional vector to specify the group of the first condition when the observed effect sizes or outcomes represent contrasts between two conditions.</p></dd>

   <dt>grp2</dt>
<dd><p>optional vector to specify the group of the second condition when the observed effect sizes or outcomes represent contrasts between two conditions.</p></dd>

   <dt>w1</dt>
<dd><p>optional numeric vector to specify the size of the group (or more generally, the inverse-sampling variance weight) of the first condition when the observed effect sizes or outcomes represent contrasts between two conditions.</p></dd>

   <dt>w2</dt>
<dd><p>optional numeric vector to specify the size of the group (or more generally, the inverse-sampling variance weight) of the second condition when the observed effect sizes or outcomes represent contrasts between two conditions.</p></dd>

   <dt>data</dt>
<dd><p>optional data frame containing the variables given to the arguments above.</p></dd>

   <dt>rho</dt>
<dd><p>argument to specify the correlation(s) of observed effect sizes or outcomes measured concurrently. See ‘Details’.</p></dd>

   <dt>phi</dt>
<dd><p>argument to specify the autocorrelation of observed effect sizes or outcomes measured at different time points. See ‘Details’.</p></dd>

   <dt>rvars</dt>
<dd><p>optional argument for specifying the variables that correspond to the correlation matrices of the studies (if this is specified, all arguments above except for <code>cluster</code> and <code>subgroup</code> are ignored). See ‘Details’.</p></dd>

   <dt>checkpd</dt>
<dd><p>logical to specify whether to check that the variance-covariance matrices within clusters are positive definite (the default is <code>TRUE</code>). See ‘Note’.</p></dd>

   <dt>nearpd</dt>
<dd><p>logical to specify whether the <code><a href="https://rdrr.io/pkg/Matrix/man/nearPD.html" class="external-link">nearPD</a></code> function from the <a href="https://cran.r-project.org/package=Matrix" class="external-link">Matrix</a> package should be used on variance-covariance matrices that are not positive definite. See ‘Note’.</p></dd>

   <dt>...</dt>
<dd><p>other arguments.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Standard meta-analytic models (such as those that can be fitted with the <code><a href="rma.uni.html">rma.uni</a></code> function) assume that the observed effect sizes or outcomes (or more precisely, their sampling errors) are independent. This assumption is typically violated whenever multiple observed effect sizes or outcomes are computed based on the same sample of subjects (or whatever the study units are) or if there is at least partial overlap of subjects that contribute information to the computation of multiple effect sizes or outcomes.</p>
<p>The present function can be used to construct or approximate the variance-covariance matrix of the sampling errors of dependent effect sizes or outcomes for a wide variety of circumstances (this variance-covariance matrix is the so-called <code>V</code> matrix that may be needed as input for multilevel/multivariate meta-analytic models as can be fitted with the <code><a href="rma.mv.html">rma.mv</a></code> function; see also <a href="misc-recs.html">here</a> for some recommendations on a general workflow for meta-analyses involving complex dependency structures).</p>
<p>Argument <code>cluster</code> is used to specify the clustering variable. Rows with the same value of this variable are allowed to be dependent, while rows with different values are assumed to be independent. Typically, <code>cluster</code> will be a study identifier.</p>
<p>Within the same cluster, there may be different subgroups with no overlap of subjects across subgroups. Argument <code>subgroup</code> can be used to distinguish such subgroups. Rows with the same value of this variable within a cluster are allowed to be dependent, while rows with different values are assumed to be independent even if they come from the same cluster. Therefore, from hereon, ‘cluster’ really refers to the combination of <code>cluster</code> and <code>subgroup</code>.</p>
<p>Multiple effect sizes or outcomes belonging to the same cluster may be dependent due to a variety of reasons:</p><ol><li><p>The same construct of interest (e.g., severity of depression) may have been measured using different scales or instruments within a study (e.g., using the Beck Depression Inventory (BDI) and the Hamilton Depression Rating Scale (HDRS)) based on which multiple effect sizes can be computed for the same group of subjects (e.g., contrasting a treatment versus a control group with respect to each scale). In this case, we have multiple effect sizes that are different ‘observations’ of the effect with respect to the same type of construct.</p>
<p>Argument <code>obs</code> is then used to distinguish different effect sizes corresponding to the same construct. If <code>obs</code> is specified, then argument <code>rho</code> must also be specified to indicate the degree of correlation among the sampling errors of the different effect sizes. Since this correlation is typically not known, the correlation among the various scales (or a rough ‘guestimate’ thereof) can be used as a proxy (i.e., the (typical) correlation between BDI and HDRS measurements).</p>
<p>One can also specify an entire correlation matrix via <code>rho</code> to indicate, for each possible pair of <code>obs</code> values, the corresponding correlation. The row/column names of the matrix must then correspond to the unique values of the <code>obs</code> variable.</p></li>
<li><p>Multiple types of constructs (or more generally, types of response/dependent variables) may have been measured in the same group of subjects (e.g., severity of depression as measured with the Beck Depression Inventory (BDI) and severity of anxiety as measured with the State-Trait Anxiety Inventory (STAI)). If this is of interest for a meta-analysis, effect sizes can then be computed with respect to each ‘type’ of construct.</p>
<p>Argument <code>type</code> is then used to distinguish effect sizes corresponding to these different types of constructs. If <code>type</code> is specified, then argument <code>rho</code> must also be specified to indicate the degree of correlation among the sampling errors of effect sizes belonging to these different types. As above, the correlation among the various scales is typically used here as a proxy (i.e., the (typical) correlation between BDI and STAI measurements).</p>
<p>One can also specify an entire correlation matrix via <code>rho</code> to indicate, for each possible pair of <code>type</code> values, the corresponding correlation. The row/column names of the matrix must then correspond to the unique values of the <code>type</code> variable.</p></li>
<li><p>If there are multiple types of constructs, multiple scales or instruments may also have been used (in at least some of the studies) to measure the same construct and hence there may again be multiple effect sizes that are ‘observations’ of the same type of construct. Arguments <code>type</code> and <code>obs</code> should then be used together to indicate the various construct types and observations thereof. In this case, argument <code>rho</code> must be a vector of two values, the first to specify the within-construct correlation and the second to specify the between-construct correlation.</p>
<p>One can also specify a list with two elements for <code>rho</code>, the first element being either a scalar or an entire correlation matrix for the within-construct correlation(s) and the second element being a scalar or an entire correlation matrix for the between-construct correlation(s). As above, any matrices specified must have row/column names corresponding to the unique values of the <code>obs</code> and/or <code>type</code> variables.</p></li>
<li><p>The same construct and scale may have been assessed/used multiple times, allowing the computation of multiple effect sizes for the same group of subjects at different time points (e.g., right after the end of a treatment, at a short-term follow-up, and at a long-term follow-up). Argument <code>time1</code> is then used to specify the time points when the observed effect sizes were obtained. Argument <code>phi</code> must then also be specified to indicate the autocorrelation among the sampling errors of two effect sizes that differ by one unit on the <code>time1</code> variable. As above, the autocorrelation of the measurements themselves can be used here as a proxy.</p>
<p>If multiple constructs and/or multiple scales have also been assessed at the various time points, then arguments <code>type</code> and/or <code>obs</code> (together with argument <code>rho</code>) should be used as needed to differentiate effect sizes corresponding to the different constructs and/or scales.</p></li>
<li><p>Many effect sizes or outcome measures (e.g., raw or standardized mean differences, log-transformed ratios of means, log risk/odds ratios and risk differences) reflect the difference between two conditions (i.e., a contrast). Within a study, there may be more than two conditions, allowing the computation of multiple such contrasts (e.g., treatment A versus a control condition and treatment B versus the same control condition) and hence corresponding effect sizes. The reuse of information from the ‘shared’ condition (in this example, the control condition) then induces correlation among the effect sizes.</p>
<p>To account for this, arguments <code>grp1</code> and <code>grp2</code> should be specified to indicate (within each cluster) which two groups were compared in the computation of each effect size (e.g., in the example above, the coding could be <code>grp1=c(1,2)</code> and <code>grp2=c(3,3)</code>; whether numbers or strings are used as identifiers is irrelevant).</p>
<p>The degree of correlation between two contrast-type effect sizes that is induced by the use of a shared condition is a function of the size of the groups involved in the computation of the two effect sizes (or, more generally, the inverse-sampling variance weights of the condition-specific outcomes). By default, the group sizes (weights) are assumed to be identical across conditions, which implies a correlation of 0.5. If the group sizes (weights) are known, they can be specified via arguments <code>w1</code> and <code>w2</code> (in which case this information is used by the function to calculate a more accurate estimate of the correlation induced by the shared condition).</p>
<p>In fact, a contrast-type effect size can be based on a between- or a within-subjects design. When at least one or more of the contrast-type effect sizes are based on a within-subjects design, then <code>time1</code> and <code>time2</code> should be used in combination with <code>grp1</code> and <code>grp2</code> to indicate for each effect size the group(s) and time point(s) involved.</p>
<p>For example, <code>grp1=c(1,2)</code> and <code>grp2=c(3,3)</code> as above in combination with <code>time1=c(1,1)</code> and <code>time2=c(1,1)</code> would imply a between-subjects design involving three groups where two effect sizes were computed contrasting groups 1 and 2 versus group 3 at a single time point. On the other hand, <code>grp1=c(1,1)</code> and <code>grp2=c(1,1)</code> in combination with <code>time1=c(2,1)</code> and <code>time2=c(3,1)</code> would imply a within-subjects design where two effect sizes were computed contrasting time points 2 and 3 versus time point 1 in a single group. Argument <code>phi</code> is then used as above to indicate the autocorrelation of the measurements within groups (i.e., for the within-subjects design above, it would be the autocorrelation between time points 2 and 1 or equivalently, between time points 3 and 2).</p></li>
</ol><p>All of the arguments above can be specified together to account for a fairly wide variety of dependency types.</p>
<p></p><div class="section">
<h3 id="using-the-rvars-argument">Using the <code>rvars</code> Argument<a class="anchor" aria-label="anchor" href="#using-the-rvars-argument"></a></h3>


<p>The function also provides an alternative approach for constructing the variance-covariance matrix using the <code>rvars</code> argument. Here, one must specify the names of the variables in the dataset that correspond to the correlation matrices of the studies (the variables should be specified as a vector; e.g., <code>c(var1, var2, var3)</code>).</p>
<p>In particular, let <em></em>\(k_i\) denote the number of rows corresponding to the <em></em>\(i\textrm{th}\) cluster. Then the values of the first <em></em>\(k_i\) variables from <code>rvars</code> are used to construct the correlation matrix and, together with the sampling variances (specified via <code>vi</code>), the variance-covariance matrix. Say there are three studies, the first with two correlated estimates, the second with a single estimate, and the third with four correlated estimates. Then the data structure should look like this:</p>
<div class="sourceCode"><pre><code>study  yi  vi  r1  r2  r3  r4
=============================
    1   .   .   1  NA  NA  NA
    1   .   .  .6   1  NA  NA
-----------------------------
    2   .   .   1  NA  NA  NA
-----------------------------
    3   .   .   1  NA  NA  NA
    3   .   .  .8   1  NA  NA
    3   .   .  .5  .5   1  NA
    3   .   .  .5  .5  .8   1
=============================</code></pre></div>

<p>with <code>rvars = c(r1, r2, r3, r4)</code>. If the <code>rvars</code> variables are a consecutive set in the data frame (as above), then one can use the shorthand notation <code>rvars = c(r1:r4)</code>, so <code>r1</code> denotes the first and <code>r4</code> the last variable in the set. Note that only the lower triangular part of the submatrices defined by the <code>rvars</code> variables is used.</p>
<p>There must be as many variables specified via <code>rvars</code> as the number of rows in the <em>largest</em> cluster (in smaller clusters, the non-relevant variables can just be set to <code>NA</code>; see above).</p>
<p></p>
</div>


    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <em></em>\(k \times k\) variance-covariance matrix, where <em></em>\(k\) denotes the length of the <code>vi</code> variable (i.e., the number of rows in the dataset).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Depending on the data structure, the specified variables, and the specified values for <code>rho</code> and/or <code>phi</code>, it is possible that the constructed variance-covariance matrix is not positive definite within one or more clusters (this is checked when <code>checkpd=TRUE</code>, which is the default). If such non-positive definite submatrices are found, the reasons for this should be carefully checked since this might indicate misapplication of the function and/or the specification of implausible values for <code>rho</code> and/or <code>phi</code>.</p>
<p>When setting <code>nearpd=TRUE</code>, the <code><a href="https://rdrr.io/pkg/Matrix/man/nearPD.html" class="external-link">nearPD</a></code> function from the <a href="https://cran.r-project.org/package=Matrix" class="external-link">Matrix</a> package is used on variance-covariance submatrices that are not positive definite. This should only be used cautiously and after understanding why these matrices are not positive definite.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Wolfgang Viechtbauer <a href="mailto:wvb@metafor-project.org">wvb@metafor-project.org</a> <a href="https://www.metafor-project.org" class="external-link">https://www.metafor-project.org</a></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1–48. <a href="https://doi.org/10.18637/jss.v036.i03" class="external-link">https://doi.org/10.18637/jss.v036.i03</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="escalc.html">escalc</a></code> for a function to compute the observed effect sizes or outcomes (and corresponding sampling variances) for which a variance-covariance matrix could be constructed.</p>
<p><code><a href="rcalc.html">rcalc</a></code> for a function to construct the variance-covariance matrix of dependent correlation coefficients.</p>
<p><code><a href="rma.mv.html">rma.mv</a></code> for a model fitting function that can be used to meta-analyze dependent effect sizes or outcomes.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">############################################################################</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### see help(dat.assink2016) for further details on this dataset</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.assink2016.html" class="external-link">dat.assink2016</a></span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">9</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   study esid id      yi     vi pubstatus year deltype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1    1  1  0.9066 0.0740         1  4.5 general</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1    2  2  0.4295 0.0398         1  4.5 general</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1    3  3  0.2679 0.0481         1  4.5 general</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1    4  4  0.2078 0.0239         1  4.5 general</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1    5  5  0.0526 0.0331         1  4.5 general</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1    6  6 -0.0507 0.0886         1  4.5 general</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     2    1  7  0.5117 0.0115         1  1.5 general</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     2    2  8  0.4738 0.0076         1  1.5 general</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     2    3  9  0.3544 0.0065         1  1.5 general</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### assume that the effect sizes within studies are correlated with rho=0.6</span></span>
<span class="r-in"><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu">vcalc</span><span class="op">(</span><span class="va">vi</span>, cluster<span class="op">=</span><span class="va">study</span>, obs<span class="op">=</span><span class="va">esid</span>, data<span class="op">=</span><span class="va">dat</span>, rho<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### show part of V matrix for studies 1 and 2</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">V</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">study</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">dat</span><span class="op">$</span><span class="va">study</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]   [,9]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.0740 0.0326 0.0358 0.0252 0.0297 0.0486 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.0326 0.0398 0.0263 0.0185 0.0218 0.0356 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.0358 0.0263 0.0481 0.0203 0.0239 0.0392 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.0252 0.0185 0.0203 0.0239 0.0169 0.0276 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.0297 0.0218 0.0239 0.0169 0.0331 0.0325 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.0486 0.0356 0.0392 0.0276 0.0325 0.0886 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0115 0.0056 0.0052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0056 0.0076 0.0042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0052 0.0042 0.0065</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### or show as list of matrices</span></span>
<span class="r-in"><span class="fu"><a href="blsplit.html">blsplit</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">dat</span><span class="op">$</span><span class="va">study</span>, <span class="va">round</span>, <span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]   [,2]   [,3]   [,4]   [,5]   [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.0740 0.0326 0.0358 0.0252 0.0297 0.0486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.0326 0.0398 0.0263 0.0185 0.0218 0.0356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.0358 0.0263 0.0481 0.0203 0.0239 0.0392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.0252 0.0185 0.0203 0.0239 0.0169 0.0276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.0297 0.0218 0.0239 0.0169 0.0331 0.0325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 0.0486 0.0356 0.0392 0.0276 0.0325 0.0886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]   [,2]   [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.0115 0.0056 0.0052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.0056 0.0076 0.0042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.0052 0.0042 0.0065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### use a correlation of 0.7 for effect sizes corresponding to the same type of</span></span>
<span class="r-in"><span class="co">### delinquent behavior and a correlation of 0.5 for effect sizes corresponding</span></span>
<span class="r-in"><span class="co">### to different types of delinquent behavior</span></span>
<span class="r-in"><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu">vcalc</span><span class="op">(</span><span class="va">vi</span>, cluster<span class="op">=</span><span class="va">study</span>, type<span class="op">=</span><span class="va">deltype</span>, obs<span class="op">=</span><span class="va">esid</span>, data<span class="op">=</span><span class="va">dat</span>, rho<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="blsplit.html">blsplit</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">dat</span><span class="op">$</span><span class="va">study</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="fl">16</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`16`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.091 0.045 0.027 0.044 0.030 0.039 0.076 0.028 0.034 0.030 0.039 0.043 0.039 0.067 0.028 0.032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.045 0.087 0.027 0.061 0.030 0.039 0.053 0.027 0.047 0.041 0.053 0.059 0.053 0.046 0.038 0.043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.027 0.027 0.033 0.027 0.025 0.033 0.033 0.023 0.021 0.018 0.023 0.026 0.023 0.029 0.017 0.019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.044 0.061 0.027 0.086 0.029 0.038 0.053 0.027 0.047 0.041 0.053 0.058 0.053 0.046 0.038 0.043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.030 0.030 0.025 0.029 0.040 0.037 0.036 0.026 0.023 0.020 0.026 0.028 0.026 0.031 0.018 0.021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.039 0.039 0.033 0.038 0.037 0.068 0.047 0.033 0.030 0.026 0.034 0.037 0.034 0.041 0.024 0.027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.076 0.053 0.033 0.053 0.036 0.047 0.129 0.033 0.041 0.035 0.046 0.051 0.046 0.079 0.033 0.037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.028 0.027 0.023 0.027 0.026 0.033 0.033 0.033 0.021 0.018 0.023 0.026 0.024 0.029 0.017 0.019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.034 0.047 0.021 0.047 0.023 0.030 0.041 0.021 0.052 0.031 0.041 0.045 0.041 0.036 0.029 0.033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.030 0.041 0.018 0.041 0.020 0.026 0.035 0.018 0.031 0.039 0.036 0.039 0.036 0.031 0.025 0.029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.039 0.053 0.023 0.053 0.026 0.034 0.046 0.023 0.041 0.036 0.066 0.051 0.047 0.040 0.033 0.038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.043 0.059 0.026 0.058 0.028 0.037 0.051 0.026 0.045 0.039 0.051 0.081 0.051 0.045 0.037 0.042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.039 0.053 0.023 0.053 0.026 0.034 0.046 0.024 0.041 0.036 0.047 0.051 0.067 0.041 0.033 0.038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.067 0.046 0.029 0.046 0.031 0.041 0.079 0.029 0.036 0.031 0.040 0.045 0.041 0.099 0.029 0.033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.028 0.038 0.017 0.038 0.018 0.024 0.033 0.017 0.029 0.025 0.033 0.037 0.033 0.029 0.034 0.027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.032 0.043 0.019 0.043 0.021 0.027 0.037 0.019 0.033 0.029 0.038 0.042 0.038 0.033 0.027 0.044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### examine the correlation matrix for study 16</span></span>
<span class="r-in"><span class="fu"><a href="blsplit.html">blsplit</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">dat</span><span class="op">$</span><span class="va">study</span>, <span class="va">cov2cor</span><span class="op">)</span><span class="op">[</span><span class="fl">16</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`16`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.0  0.5  0.5  0.5  0.5  0.5  0.7  0.5  0.5   0.5   0.5   0.5   0.5   0.7   0.5   0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.5  1.0  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   0.7   0.5   0.7   0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.5  0.5  1.0  0.5  0.7  0.7  0.5  0.7  0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.5  0.7  0.5  1.0  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   0.7   0.5   0.7   0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.5  0.5  0.7  0.5  1.0  0.7  0.5  0.7  0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.5  0.5  0.7  0.5  0.7  1.0  0.5  0.7  0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  0.7  0.5  0.5  0.5  0.5  0.5  1.0  0.5  0.5   0.5   0.5   0.5   0.5   0.7   0.5   0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.5  0.5  0.7  0.5  0.7  0.7  0.5  1.0  0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  1.0   0.7   0.7   0.7   0.7   0.5   0.7   0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   1.0   0.7   0.7   0.7   0.5   0.7   0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   1.0   0.7   0.7   0.5   0.7   0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   1.0   0.7   0.5   0.7   0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   1.0   0.5   0.7   0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]  0.7  0.5  0.5  0.5  0.5  0.5  0.7  0.5  0.5   0.5   0.5   0.5   0.5   1.0   0.5   0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   0.7   0.5   1.0   0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  0.5  0.7  0.5  0.7  0.5  0.5  0.5  0.5  0.7   0.7   0.7   0.7   0.7   0.5   0.7   1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">############################################################################</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### see help(dat.ishak2007) for further details on this dataset</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.ishak2007.html" class="external-link">dat.ishak2007</a></span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">5</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               study   y1i  v1i   y2i   v2i   y3i v3i  y4i  v4i mdur mbase </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Alegret (2001) -33.4 14.3    NA    NA    NA  NA &lt;NA&gt; &lt;NA&gt; 16.1  53.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Barichella (2003) -20.0  7.3    NA    NA -30.0 5.7 &lt;NA&gt; &lt;NA&gt; 13.5  45.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Berney (2002) -21.1  7.3    NA    NA    NA  NA &lt;NA&gt; &lt;NA&gt; 13.6  45.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Burchiel (1999) -20.0  8.0 -20.0   8.0 -18.0 5.0 &lt;NA&gt; &lt;NA&gt; 13.6  48.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       Chen (2003)    NA   NA -32.9 125.0    NA  NA &lt;NA&gt; &lt;NA&gt; 12.1  65.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### create long format dataset</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span><span class="va">dat</span>, direction<span class="op">=</span><span class="st">"long"</span>, idvar<span class="op">=</span><span class="st">"study"</span>, v.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yi"</span>,<span class="st">"vi"</span><span class="op">)</span>,</span>
<span class="r-in">               varying<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">time</span><span class="op">)</span>,<span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### remove missing measurement occasions from dat</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">yi</span><span class="op">)</span>,<span class="op">]</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### show the data for the first 5 studies</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">8</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               study mdur mbase time    yi    vi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Alegret (2001) 16.1  53.6    1 -33.4  14.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Barichella (2003) 13.5  45.3    1 -20.0   7.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Barichella (2003) 13.5  45.3    3 -30.0   5.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Berney (2002) 13.6  45.6    1 -21.1   7.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Burchiel (1999) 13.6  48.0    1 -20.0   8.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Burchiel (1999) 13.6  48.0    2 -20.0   8.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Burchiel (1999) 13.6  48.0    3 -18.0   5.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       Chen (2003) 12.1  65.7    2 -32.9 125.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### construct the full (block diagonal) V matrix with an AR(1) structure</span></span>
<span class="r-in"><span class="co">### assuming an autocorrelation of 0.97 as estimated by Ishak et al. (2007)</span></span>
<span class="r-in"><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu">vcalc</span><span class="op">(</span><span class="va">vi</span>, cluster<span class="op">=</span><span class="va">study</span>, time1<span class="op">=</span><span class="va">time</span>, phi<span class="op">=</span><span class="fl">0.97</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span class="r-in"><span class="va">V</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]     [,2]     [,3] [,4]     [,5]     [,6]     [,7] [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 14.3 0.000000 0.000000  0.0 0.000000 0.000000 0.000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0 7.300000 6.069352  0.0 0.000000 0.000000 0.000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0 6.069352 5.700000  0.0 0.000000 0.000000 0.000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0 0.000000 0.000000  7.3 0.000000 0.000000 0.000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.0 0.000000 0.000000  0.0 8.000000 7.760000 5.950774    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.0 0.000000 0.000000  0.0 7.760000 8.000000 6.134819    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,]  0.0 0.000000 0.000000  0.0 5.950774 6.134819 5.000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8,]  0.0 0.000000 0.000000  0.0 0.000000 0.000000 0.000000  125</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="va">V</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]   [,2]   [,3] [,4]   [,5] [,6]   [,7] [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1 0.0000 0.0000    0 0.0000 0.00 0.0000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0 1.0000 0.9409    0 0.0000 0.00 0.0000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0 0.9409 1.0000    0 0.0000 0.00 0.0000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0 0.0000 0.0000    1 0.0000 0.00 0.0000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    0 0.0000 0.0000    0 1.0000 0.97 0.9409    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]    0 0.0000 0.0000    0 0.9700 1.00 0.9700    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,]    0 0.0000 0.0000    0 0.9409 0.97 1.0000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8,]    0 0.0000 0.0000    0 0.0000 0.00 0.0000    1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### or show as a list of matrices</span></span>
<span class="r-in"><span class="fu"><a href="blsplit.html">blsplit</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">dat</span><span class="op">$</span><span class="va">study</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Alegret (2001)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Barichella (2003)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 7.300000 6.069352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 6.069352 5.700000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Berney (2002)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  7.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Burchiel (1999)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 8.000000 7.760000 5.950774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 7.760000 8.000000 6.134819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 5.950774 6.134819 5.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Chen (2003)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="blsplit.html">blsplit</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">dat</span><span class="op">$</span><span class="va">study</span>, <span class="va">cov2cor</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Alegret (2001)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Barichella (2003)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000 0.9409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.9409 1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Berney (2002)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Burchiel (1999)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1] [,2]   [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000 0.97 0.9409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.9700 1.00 0.9700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.9409 0.97 1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Chen (2003)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">############################################################################</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### see help(dat.kalaian1996) for further details on this dataset</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.kalaian1996.html" class="external-link">dat.kalaian1996</a></span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">12</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id                 study year n1i n2i outcome    yi     vi  hrs ets homework type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 Alderman &amp; Powers (A) 1980  28  22  verbal  0.22 0.0817  7.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2 Alderman &amp; Powers (B) 1980  39  40  verbal  0.09 0.0507 10.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   3 Alderman &amp; Powers (C) 1980  22  17  verbal  0.14 0.1045 10.5   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   4 Alderman &amp; Powers (D) 1980  48  43  verbal  0.14 0.0442 10.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   5 Alderman &amp; Powers (E) 1980  25  74  verbal -0.01 0.0535  6.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   6 Alderman &amp; Powers (F) 1980  37  35  verbal  0.14 0.0557  5.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   7 Alderman &amp; Powers (G) 1980  24  70  verbal  0.18 0.0561 11.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   8 Alderman &amp; Powers (H) 1980  16  19  verbal  0.01 0.1151 45.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   9      Evans &amp; Pike (A) 1973 145 129  verbal  0.13 0.0147 21.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 10      Evans &amp; Pike (A) 1973 145 129    math  0.12 0.0147 21.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 11      Evans &amp; Pike (B) 1973  72 129  verbal  0.25 0.0218 21.0   1        1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 12      Evans &amp; Pike (B) 1973  72 129    math  0.06 0.0216 21.0   1        1    1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### construct the variance-covariance matrix assuming rho = 0.66 for effect sizes</span></span>
<span class="r-in"><span class="co">### corresponding to the 'verbal' and 'math' outcome types</span></span>
<span class="r-in"><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu">vcalc</span><span class="op">(</span><span class="va">vi</span>, cluster<span class="op">=</span><span class="va">study</span>, type<span class="op">=</span><span class="va">outcome</span>, data<span class="op">=</span><span class="va">dat</span>, rho<span class="op">=</span><span class="fl">0.66</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">V</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]   [,9]  [,10]  [,11]  [,12]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.0817 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.0000 0.0507 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.0000 0.0000 0.1045 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.0000 0.0000 0.0000 0.0442 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.0000 0.0000 0.0000 0.0000 0.0535 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0557 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0561 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.1151 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0147 0.0097 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0097 0.0147 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0218 0.0143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0143 0.0216</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">############################################################################</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### see help(dat.berkey1998) for further details on this dataset</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.berkey1998.html" class="external-link">dat.berkey1998</a></span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### variables v1i and v2i correspond to the 2x2 var-cov matrices of the studies;</span></span>
<span class="r-in"><span class="co">### so use these variables to construct the V matrix (note: since v1i and v2i are</span></span>
<span class="r-in"><span class="co">### var-cov matrices and not correlation matrices, set vi=1 for all rows)</span></span>
<span class="r-in"><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu">vcalc</span><span class="op">(</span>vi<span class="op">=</span><span class="fl">1</span>, cluster<span class="op">=</span><span class="va">author</span>, rvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">v1i</span>, <span class="va">v2i</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span class="r-in"><span class="va">V</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]   [,2]   [,3]  [,4]   [,5]   [,6]   [,7]   [,8]   [,9]  [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.0075 0.0030 0.0000 0e+00 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.0030 0.0077 0.0000 0e+00 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.0000 0.0000 0.0057 9e-04 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.0000 0.0000 0.0009 8e-04 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.0000 0.0000 0.0000 0e+00 0.0021 0.0007 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.0000 0.0000 0.0000 0e+00 0.0007 0.0014 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.0000 0.0000 0.0000 0e+00 0.0000 0.0000 0.0029 0.0009 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.0000 0.0000 0.0000 0e+00 0.0000 0.0000 0.0009 0.0015 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.0000 0.0000 0.0000 0e+00 0.0000 0.0000 0.0000 0.0000 0.0148 0.0072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.0000 0.0000 0.0000 0e+00 0.0000 0.0000 0.0000 0.0000 0.0072 0.0304</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 1.00 0.39 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.39 1.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.00 0.00 1.00 0.42 0.00 0.00 0.00 0.00 0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.00 0.00 0.42 1.00 0.00 0.00 0.00 0.00 0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.00 0.00 0.00 0.00 1.00 0.41 0.00 0.00 0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.00 0.00 0.00 0.00 0.41 1.00 0.00 0.00 0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.00 0.00 0.00 0.00 0.00 0.00 1.00 0.43 0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.00 0.00 0.00 0.00 0.00 0.00 0.43 1.00 0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 1.00  0.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.34  1.00</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### or show as a list of matrices</span></span>
<span class="r-in"><span class="fu"><a href="blsplit.html">blsplit</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">dat</span><span class="op">$</span><span class="va">author</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Pihlstrom et al.`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00 0.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.39 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Lindhe et al.`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00 0.42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.42 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Knowles et al.`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00 0.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.41 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Ramfjord et al.`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00 0.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.43 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Becker et al.`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00 0.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.34 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### construct the variance-covariance matrix assuming rho = 0.4 for effect sizes</span></span>
<span class="r-in"><span class="co">### corresponding to the 'PD' and 'AL' outcome types</span></span>
<span class="r-in"><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu">vcalc</span><span class="op">(</span>vi<span class="op">=</span><span class="va">vi</span>, cluster<span class="op">=</span><span class="va">trial</span>, type<span class="op">=</span><span class="va">outcome</span>, data<span class="op">=</span><span class="va">dat</span>, rho<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">V</span>,<span class="fl">4</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]   [,2]   [,3]  [,4]   [,5]   [,6]   [,7]   [,8]   [,9]  [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.0075 0.0030 0.0000 0e+00 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.0030 0.0077 0.0000 0e+00 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.0000 0.0000 0.0057 9e-04 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.0000 0.0000 0.0009 8e-04 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.0000 0.0000 0.0000 0e+00 0.0021 0.0007 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.0000 0.0000 0.0000 0e+00 0.0007 0.0014 0.0000 0.0000 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.0000 0.0000 0.0000 0e+00 0.0000 0.0000 0.0029 0.0008 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.0000 0.0000 0.0000 0e+00 0.0000 0.0000 0.0008 0.0015 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.0000 0.0000 0.0000 0e+00 0.0000 0.0000 0.0000 0.0000 0.0148 0.0085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.0000 0.0000 0.0000 0e+00 0.0000 0.0000 0.0000 0.0000 0.0085 0.0304</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.0  0.4  0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.4  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.0  0.0  1.0  0.4  0.0  0.0  0.0  0.0  0.0   0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.0  0.0  0.4  1.0  0.0  0.0  0.0  0.0  0.0   0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.0  0.0  0.0  0.0  1.0  0.4  0.0  0.0  0.0   0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.0  0.0  0.0  0.0  0.4  1.0  0.0  0.0  0.0   0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.4  0.0   0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.0  0.0  0.0  0.0  0.0  0.0  0.4  1.0  0.0   0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0   0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.4   1.0</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">############################################################################</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### see help(dat.knapp2017) for further details on this dataset</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metadat/reference/dat.knapp2017.html" class="external-link">dat.knapp2017</a></span></span>
<span class="r-in"><span class="va">dat</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    study            task difficulty group1 group2 comp    yi    vi n_sz n_hc yi_iq vi_iq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1    SOC (CANTAB)       3.83     SZ     HC    1  0.62 0.075   24   33  0.72 0.076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      2    SOC (CANTAB)       3.83    SZ1     HC    1  0.46 0.047   44   44    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      2    SOC (CANTAB)       3.83    SZ2     HC    2  0.73 0.052   38   44    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      3    SOC (CANTAB)       3.83    SZ1     HC    1  1.18 0.062   39   37    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      3    SOC (CANTAB)       3.83    SZ2     HC    2  1.09 0.073   27   37    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      3    SOC (CANTAB)       3.83    SZ3     HC    3  0.91 0.102   15   37    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      3    SOC (CANTAB)       3.83    SZ4     HC    4  0.91 0.084   20   37    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      4             TOH         NA     SZ     HC    1  0.57 0.074   28   28    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      5             TOL         NA     SZ     HC    1  0.40 0.180   13   10    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     6    SOC (CANTAB)       2.00     SZ     HC    1  0.43 0.170   12   12  0.12 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     6    SOC (CANTAB)       3.00     SZ     HC    2  1.37 0.206   12   12  0.12 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     6    SOC (CANTAB)       4.00     SZ     HC    3  0.23 0.168   12   12  0.12 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     6    SOC (CANTAB)       5.00     SZ     HC    4  0.97 0.186   12   12  0.12 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     6 SOC (one-touch)       2.00     SZ     HC    5  0.56 0.173   12   12  0.12 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     6 SOC (one-touch)       3.00     SZ     HC    6  0.79 0.180   12   12  0.12 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     6 SOC (one-touch)       4.00     SZ     HC    7  1.19 0.196   12   12  0.12 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     6 SOC (one-touch)       5.00     SZ     HC    8  0.92 0.184   12   12  0.12 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     7             SOC       3.50     SZ     HC    1  0.20 0.096   22   20  0.62 0.100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     8             TOH         NA     SZ     HC    1  1.42 0.180   13   15    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     9             TOL       4.00    SZ1     HC    1  0.35 0.074   27   28  1.21 0.086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     9             TOL       4.00    SZ2     HC    2  0.88 0.078   28   28  1.26 0.086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    10    SOC (CANTAB)       3.83     SZ     HC    1  1.08 0.079   26   33  0.76 0.074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    11    SOC (CANTAB)       3.83     SZ     HC    1  0.94 0.111   20   20  0.42 0.102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    12    SOC (CANTAB)       2.00     SZ     HC    1  0.44 0.020  135   81  0.49 0.020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25    12    SOC (CANTAB)       3.00     SZ     HC    2  0.63 0.021  135   81  0.49 0.020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26    12    SOC (CANTAB)       4.00     SZ     HC    3  0.38 0.020  135   81  0.49 0.020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27    12    SOC (CANTAB)       5.00     SZ     HC    4  0.93 0.022  135   81  0.49 0.020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28    13             TOL         NA     SZ     HC    1  0.33 0.102   24   17    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29    14             TOL       2.00     SZ     HC    1  0.00 0.073   32   24    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30    14             TOL       3.00     SZ     HC    2 -0.06 0.073   32   24    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31    14             TOL       4.00     SZ     HC    3  0.73 0.078   32   24    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32    14             TOL       5.00     SZ     HC    4  0.48 0.075   32   24    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33    15             TOL       2.00     SZ     HC    1  0.43 0.092   25   20    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34    15             TOL       3.00     SZ     HC    2  0.72 0.096   25   20    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35    15             TOL       4.00     SZ     HC    3  0.80 0.097   25   20    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36    15             TOL       5.00     SZ     HC    4  1.30 0.109   25   20    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37    16             TOL       4.67     SZ     HC    1  1.84 0.190   15   15    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38    17             TOL       3.50     SZ     HC    1  2.58 0.216   17   17  0.58 0.123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39    18             TOL       3.00     SZ     HC    1  0.25 0.071   30   27  0.18 0.071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40    18             TOL       4.00     SZ     HC    2  0.86 0.077   30   27  0.18 0.071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41    18             TOL       5.00     SZ     HC    3  0.68 0.074   30   27  0.18 0.071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42    19    SOC (CANTAB)       2.00     SZ     HC    1  0.21 0.060   36   31  0.48 0.062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43    19    SOC (CANTAB)       3.00     SZ     HC    2  0.65 0.063   36   31  0.48 0.062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44    19    SOC (CANTAB)       4.00     SZ     HC    3  0.30 0.061   36   31  0.48 0.062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45    19    SOC (CANTAB)       5.00     SZ     HC    4  0.45 0.062   36   31  0.48 0.062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46    20          BACS-J         NA    SZ1     HC    1  1.03 0.054   20  340    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47    20          BACS-J         NA    SZ2     HC    2  0.92 0.104   10  340    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48    21    SOC (CANTAB)       3.83     SZ     HC    1  1.12 0.108   28   17    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49    22             TOL       2.00     SZ     HC    1  0.52 0.052   40   40    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50    22             TOL       3.00     SZ     HC    2  0.50 0.052   40   40    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51    22             TOL       4.00     SZ     HC    3  0.49 0.051   40   40    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52    23             SOC       3.83     SZ     HC    1  0.30 0.042   48   48    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53    24      TOL-Drexel       5.50    SZ1    HC1    1  0.36 0.022   86   97  0.47 0.023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54    24      TOL-Drexel       5.50    SZ2    HC2    2  0.41 0.030   75   62  0.10 0.030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55    25             SOC       3.83     SZ     HC    1  0.79 0.086   25   25    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56    26             SOC       2.00     SZ     HC    1  0.23 0.031   77   55    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57    26             SOC       3.00     SZ     HC    2  0.58 0.032   77   55    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58    26             SOC       4.00     SZ     HC    3  0.57 0.032   77   55    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59    26             SOC       5.00     SZ     HC    4  0.79 0.034   77   55    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60    27      TOL-Drexel       5.50     SZ     HC    1  0.70 0.071   30   30    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61    28             SOC       3.83     SZ     HC    1  1.16 0.136   20   15  0.23 0.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62    29          BACS-J         NA    SZ1    HC1    1  1.29 0.039   56   68  0.37 0.033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63    29          BACS-J         NA    SZ2    HC2    2  0.63 0.039   47   62  0.43 0.038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64    29          BACS-J         NA    SZ3    HC3    3  0.31 0.121   15   19  1.00 0.134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65    30             TOL       3.83     SZ     HC    1  0.11 0.070   30   27    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66    31 TOL (four-disk)       5.60     SZ     HC    1  0.87 0.036   60   60    NA    NA</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### create variable that indicates the task and difficulty combination as increasing integers</span></span>
<span class="r-in"><span class="va">dat</span><span class="op">$</span><span class="va">task.diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">dat</span><span class="op">$</span><span class="va">study</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">   <span class="va">task.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">task</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">   <span class="va">diff.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">difficulty</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">   <span class="va">diff.int</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">diff.int</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span class="r-in">   <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">task.int</span>, <span class="st">"."</span>, <span class="va">diff.int</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### construct correlation matrix for two tasks with four different difficulties where the</span></span>
<span class="r-in"><span class="co">### correlation is 0.4 for different difficulties of the same task, 0.7 for the same</span></span>
<span class="r-in"><span class="co">### difficulty of different tasks, and 0.28 for different difficulties of different tasks</span></span>
<span class="r-in"><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.4</span>, nrow<span class="op">=</span><span class="fl">8</span>, ncol<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span>
<span class="r-in"><span class="va">R</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">R</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.28</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, <span class="st">"."</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="va">R</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.1  1.2  1.3  1.4  2.1  2.2  2.3  2.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.1 1.00 0.40 0.40 0.40 0.70 0.28 0.28 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.2 0.40 1.00 0.40 0.40 0.28 0.70 0.28 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.3 0.40 0.40 1.00 0.40 0.28 0.28 0.70 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.4 0.40 0.40 0.40 1.00 0.28 0.28 0.28 0.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1 0.70 0.28 0.28 0.28 1.00 0.40 0.40 0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2 0.28 0.70 0.28 0.28 0.40 1.00 0.40 0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.3 0.28 0.28 0.70 0.28 0.40 0.40 1.00 0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.4 0.28 0.28 0.28 0.70 0.40 0.40 0.40 1.00</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### construct an approximate V matrix accounting for the use of shared groups and</span></span>
<span class="r-in"><span class="co">### for correlations among tasks/difficulties as specified in the R matrix above</span></span>
<span class="r-in"><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu">vcalc</span><span class="op">(</span><span class="va">vi</span>, cluster<span class="op">=</span><span class="va">study</span>, grp1<span class="op">=</span><span class="va">group1</span>, grp2<span class="op">=</span><span class="va">group2</span>, w1<span class="op">=</span><span class="va">n_sz</span>, w2<span class="op">=</span><span class="va">n_hc</span>,</span>
<span class="r-in">           obs<span class="op">=</span><span class="va">task.diff</span>, rho<span class="op">=</span><span class="va">R</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="blsplit.html">blsplit</a></span><span class="op">(</span><span class="va">V</span>, <span class="va">dat</span><span class="op">$</span><span class="va">study</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="va">Vs</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>  <span class="co"># study with multiple SZ groups and a single HC group</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]      [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000000 0.4652832 0.3847419 0.4243294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4652832 1.0000000 0.3488477 0.3847419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.3847419 0.3488477 1.0000000 0.3181424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.4243294 0.3847419 0.3181424 1.0000000</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="va">Vs</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>  <span class="co"># study with two task types and multiple difficulties</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00 0.40 0.40 0.40 0.70 0.28 0.28 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.40 1.00 0.40 0.40 0.28 0.70 0.28 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.40 0.40 1.00 0.40 0.28 0.28 0.70 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.40 0.40 0.40 1.00 0.28 0.28 0.28 0.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.70 0.28 0.28 0.28 1.00 0.40 0.40 0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 0.28 0.70 0.28 0.28 0.40 1.00 0.40 0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,] 0.28 0.28 0.70 0.28 0.40 0.40 1.00 0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8,] 0.28 0.28 0.28 0.70 0.40 0.40 0.40 1.00</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="va">Vs</span><span class="op">[[</span><span class="fl">12</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># study with multiple difficulties for the same task</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.0  0.4  0.4  0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.4  1.0  0.4  0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.4  0.4  1.0  0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.4  0.4  0.4  1.0</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="va">Vs</span><span class="op">[[</span><span class="fl">24</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># study with separate rows for males and females</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="va">Vs</span><span class="op">[[</span><span class="fl">29</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># study with separate rows for three genotypes</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">############################################################################</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.9000.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    appId: 'SFWCWKDGL8',
    
    apiKey: 'b56f56470243cf9799f796a3d6ecaedd',
    indexName: 'metafor',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

